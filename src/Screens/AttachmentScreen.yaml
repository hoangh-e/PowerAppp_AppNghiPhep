Screens:
  AttachmentScreen:
    Properties:
      Fill: =RGBA(248, 250, 252, 1)
      OnVisible: =Set(varActiveScreen, "Attachment"); Set(varAttachments, Table({ID: "ATT001", LeaveRequestID: "LR001", FileName: "Giay_xac_nhan_benh.pdf", FileSize: "2.3 MB", UploadDate: "14/01/2024", UploadBy: "Nguy·ªÖn VƒÉn An", FileType: "PDF"}, {ID: "ATT002", LeaveRequestID: "LR002", FileName: "Hop_dong_cong_tac.docx", FileSize: "1.8 MB", UploadDate: "20/02/2024", UploadBy: "Tr·∫ßn Th·ªã B√¨nh", FileType: "Word"}, {ID: "ATT003", LeaveRequestID: "LR003", FileName: "Giay_moi_dam_cuoi.jpg", FileSize: "3.2 MB", UploadDate: "15/03/2024", UploadBy: "L√™ VƒÉn C∆∞·ªùng", FileType: "Image"})); Set(varSelectedAttachment, Blank()); Set(varUploadFile, Blank())
    Children:
      - 'Attachment.Header':
          Control: HeaderComponent
          Properties:
            X: =0
            Y: =0
            Width: =Parent.Width
            Height: =80
            Title: ="Qu·∫£n l√Ω file ƒë√≠nh k√®m"
            UserName: =varCurrentUser.FullName
            UserRole: =varCurrentUser.Role
            ShowNotification: =true
            NotificationCount: =CountRows(varAttachments)
            
      - 'Attachment.Navigation':
          Control: NavigationComponent
          Properties:
            X: =0
            Y: ='Attachment.Header'.Y + 'Attachment.Header'.Height
            Width: =250
            Height: =Parent.Height - 'Attachment.Header'.Height
            UserRole: =varCurrentUser.Role
            ActiveScreen: =varActiveScreen
            OnNavigate: =Set(varNavigateAction, true)
            
      - 'Attachment.Content.Container':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: ='Attachment.Navigation'.X + 'Attachment.Navigation'.Width
            Y: ='Attachment.Header'.Y + 'Attachment.Header'.Height
            Width: =Parent.Width - 'Attachment.Navigation'.Width
            Height: =Parent.Height - 'Attachment.Header'.Height
            Fill: =RGBA(248, 250, 252, 1)
          Children:
            - 'Attachment.Content.Title':
                Control: Label
                Properties:
                  X: =Parent.X + 30
                  Y: =Parent.Y + 30
                  Width: =Parent.Width - 60
                  Height: =40
                  Text: ="Qu·∫£n l√Ω file ƒë√≠nh k√®m ƒë∆°n ngh·ªâ ph√©p"
                  Color: =RGBA(32, 54, 71, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Size: =24
                  
            - 'Attachment.Upload.Container':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.X + 30
                  Y: ='Attachment.Content.Title'.Y + 'Attachment.Content.Title'.Height + 20
                  Width: =Parent.Width - 60
                  Height: =120
                  Fill: =RGBA(255, 255, 255, 1)
                  BorderColor: =RGBA(230, 230, 230, 1)
                  BorderThickness: =1
                  DropShadow: =DropShadow.Light
                Children:
                  - 'Attachment.Upload.Title':
                      Control: Label
                      Properties:
                        X: =Parent.X + 20
                        Y: =Parent.Y + 15
                        Width: =Parent.Width - 40
                        Height: =25
                        Text: ="üìé T·∫£i l√™n file ƒë√≠nh k√®m"
                        Color: =RGBA(32, 54, 71, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =16
                        
                  - 'Attachment.Upload.Info':
                      Control: Label
                      Properties:
                        X: =Parent.X + 20
                        Y: ='Attachment.Upload.Title'.Y + 'Attachment.Upload.Title'.Height + 5
                        Width: =Parent.Width - 200
                        Height: =40
                        Text: ="Ch·ªçn file ƒë·ªÉ ƒë√≠nh k√®m v√†o ƒë∆°n ngh·ªâ ph√©p. H·ªó tr·ª£: PDF, Word, Excel, Image" & Char(10) & "K√≠ch th∆∞·ªõc t·ªëi ƒëa: 10MB"
                        Color: =RGBA(108, 117, 125, 1)
                        Font: =Font.'Open Sans'
                        Size: =12
                        
                  - 'Attachment.Upload.Button':
                      Control: Classic/Button
                      Properties:
                        X: =Parent.Width - 160
                        Y: ='Attachment.Upload.Title'.Y + 10
                        Width: =140
                        Height: =40
                        Text: ="üìÅ Ch·ªçn file"
                        Fill: =RGBA(0, 120, 212, 1)
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =12
                        OnSelect: =Notify("Ch·ª©c nƒÉng upload file s·∫Ω ƒë∆∞·ª£c t√≠ch h·ª£p v·ªõi SharePoint", NotificationType.Information)
                        
                  - 'Attachment.Upload.Status':
                      Control: Label
                      Properties:
                        X: =Parent.X + 20
                        Y: ='Attachment.Upload.Info'.Y + 'Attachment.Upload.Info'.Height + 5
                        Width: =Parent.Width - 40
                        Height: =20
                        Text: =If(IsBlank(varUploadFile), "", "‚úÖ ƒê√£ ch·ªçn file: " & varUploadFile)
                        Color: =RGBA(40, 167, 69, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =11
                        Visible: =Not(IsBlank(varUploadFile))
                        
            - 'Attachment.List.Container':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.X + 30
                  Y: ='Attachment.Upload.Container'.Y + 'Attachment.Upload.Container'.Height + 20
                  Width: =Parent.Width - 60
                  Height: =Parent.Height - 220
                  Fill: =RGBA(255, 255, 255, 1)
                  BorderColor: =RGBA(230, 230, 230, 1)
                  BorderThickness: =1
                  DropShadow: =DropShadow.Light
                Children:
                  - 'Attachment.List.Title':
                      Control: Label
                      Properties:
                        X: =Parent.X + 20
                        Y: =Parent.Y + 20
                        Width: =Parent.Width - 40
                        Height: =30
                        Text: ="üìã Danh s√°ch file ƒë√≠nh k√®m"
                        Color: =RGBA(32, 54, 71, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =16
                        
                  - 'Attachment.List.Gallery':
                      Control: Gallery
                      Variant: Vertical
                      Properties:
                        X: =Parent.X + 20
                        Y: ='Attachment.List.Title'.Y + 'Attachment.List.Title'.Height + 10
                        Width: =Parent.Width - 40
                        Height: =Parent.Height - 80
                        Items: =varAttachments
                        TemplateSize: =80
                        TemplatePadding: =10
                      Children:
                        - 'Gallery.Attachment.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.TemplateWidth
                              Height: =Parent.TemplateHeight
                              Fill: =If(varSelectedAttachment.ID = ThisItem.ID, RGBA(240, 248, 255, 1), RGBA(248, 249, 250, 1))
                              BorderColor: =If(varSelectedAttachment.ID = ThisItem.ID, RGBA(0, 120, 212, 1), RGBA(230, 230, 230, 1))
                              BorderThickness: =If(varSelectedAttachment.ID = ThisItem.ID, 2, 1)
                              OnSelect: =Set(varSelectedAttachment, ThisItem)
                            Children:
                              - 'Gallery.Attachment.Icon':
                                  Control: Label
                                  Properties:
                                    X: =Parent.X + 15
                                    Y: =Parent.Y + 15
                                    Width: =40
                                    Height: =40
                                    Text: =If(ThisItem.FileType = "PDF", "üìÑ", If(ThisItem.FileType = "Word", "üìù", If(ThisItem.FileType = "Image", "üñºÔ∏è", "üìÅ")))
                                    Color: =If(ThisItem.FileType = "PDF", RGBA(220, 53, 69, 1), If(ThisItem.FileType = "Word", RGBA(0, 120, 212, 1), If(ThisItem.FileType = "Image", RGBA(40, 167, 69, 1), RGBA(108, 117, 125, 1))))
                                    Font: =Font.'Open Sans'
                                    Size: =24
                                    Align: =Align.Center
                                    
                              - 'Gallery.Attachment.Info':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: ='Gallery.Attachment.Icon'.X + 'Gallery.Attachment.Icon'.Width + 10
                                    Y: =Parent.Y + 10
                                    Width: =Parent.Width - 120
                                    Height: =50
                                  Children:
                                    - 'Gallery.Attachment.FileName':
                                        Control: Label
                                        Properties:
                                          X: =Parent.X
                                          Y: =Parent.Y
                                          Width: =Parent.Width
                                          Height: =20
                                          Text: =ThisItem.FileName
                                          Color: =RGBA(32, 54, 71, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Size: =12
                                          
                                    - 'Gallery.Attachment.Details':
                                        Control: Label
                                        Properties:
                                          X: =Parent.X
                                          Y: ='Gallery.Attachment.FileName'.Y + 'Gallery.Attachment.FileName'.Height + 2
                                          Width: =Parent.Width
                                          Height: =15
                                          Text: =ThisItem.FileSize & " ‚Ä¢ " & ThisItem.UploadDate & " ‚Ä¢ " & ThisItem.UploadBy
                                          Color: =RGBA(108, 117, 125, 1)
                                          Font: =Font.'Open Sans'
                                          Size: =10
                                          
                                    - 'Gallery.Attachment.LeaveID':
                                        Control: Label
                                        Properties:
                                          X: =Parent.X
                                          Y: ='Gallery.Attachment.Details'.Y + 'Gallery.Attachment.Details'.Height + 2
                                          Width: =Parent.Width
                                          Height: =15
                                          Text: ="ƒê∆°n: " & ThisItem.LeaveRequestID
                                          Color: =RGBA(0, 120, 212, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Size: =10
                                          
                              - 'Gallery.Attachment.Actions':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =Parent.Width - 80
                                    Y: =Parent.Y + 10
                                    Width: =70
                                    Height: =50
                                  Children:
                                    - 'Gallery.Attachment.Download':
                                        Control: Classic/Button
                                        Properties:
                                          X: =Parent.X
                                          Y: =Parent.Y
                                          Width: =30
                                          Height: =30
                                          Text: ="‚¨áÔ∏è"
                                          Fill: =RGBA(40, 167, 69, 1)
                                          Color: =RGBA(255, 255, 255, 1)
                                          Font: =Font.'Open Sans'
                                          Size: =12
                                          OnSelect: =Notify("T·∫£i xu·ªëng file: " & ThisItem.FileName, NotificationType.Success)
                                          
                                    - 'Gallery.Attachment.Delete':
                                        Control: Classic/Button
                                        Properties:
                                          X: ='Gallery.Attachment.Download'.X + 'Gallery.Attachment.Download'.Width + 5
                                          Y: =Parent.Y
                                          Width: =30
                                          Height: =30
                                          Text: ="üóëÔ∏è"
                                          Fill: =RGBA(220, 53, 69, 1)
                                          Color: =RGBA(255, 255, 255, 1)
                                          Font: =Font.'Open Sans'
                                          Size: =12
                                          Visible: =Or(varCurrentUser.Role = "Admin", varCurrentUser.Role = "HR")
                                          OnSelect: =If(Confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a file n√†y?"), Set(varAttachments, Filter(varAttachments, ID <> ThisItem.ID)); Notify("ƒê√£ x√≥a file: " & ThisItem.FileName, NotificationType.Warning), "")
                                            
                                    - 'Gallery.Attachment.View':
                                        Control: Classic/Button
                                        Properties:
                                          X: =Parent.X
                                          Y: ='Gallery.Attachment.Download'.Y + 'Gallery.Attachment.Download'.Height + 5
                                          Width: =65
                                          Height: =25
                                          Text: ="üëÅÔ∏è Xem"
                                          Fill: =RGBA(0, 120, 212, 1)
                                          Color: =RGBA(255, 255, 255, 1)
                                          Font: =Font.'Open Sans'
                                          Size: =10
                                          OnSelect: =Notify("M·ªü file: " & ThisItem.FileName, NotificationType.Information) 