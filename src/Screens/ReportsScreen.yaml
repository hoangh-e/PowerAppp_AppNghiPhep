Screens:
  ReportsScreen:
    Properties:
      Fill: =RGBA(248, 250, 252, 1)
      OnVisible: =Set(varActiveScreen, "Reports"); Set(varReportPeriod, "Month"); Set(varSelectedMonth, Month(Today())); Set(varSelectedYear, Year(Today())); Set(varSelectedDepartment, "All"); Set(varMonthlyStats, Table({Month: "01/2024", TotalRequests: 15, ApprovedRequests: 12, PendingRequests: 2, RejectedRequests: 1, TotalDays: 45, Employees: 25}, {Month: "02/2024", TotalRequests: 18, ApprovedRequests: 15, PendingRequests: 1, RejectedRequests: 2, TotalDays: 52, Employees: 28}, {Month: "03/2024", TotalRequests: 12, ApprovedRequests: 10, PendingRequests: 1, RejectedRequests: 1, TotalDays: 36, Employees: 22}, {Month: "04/2024", TotalRequests: 20, ApprovedRequests: 18, PendingRequests: 0, RejectedRequests: 2, TotalDays: 65, Employees: 30})); Set(varDepartmentStats, Table({Department: "Ph√≤ng C√¥ng ngh·ªá th√¥ng tin", TotalRequests: 25, TotalDays: 78, AvgDays: 3.1, Employees: 8}, {Department: "Ph√≤ng Nh√¢n s·ª±", TotalRequests: 18, TotalDays: 54, AvgDays: 3.0, Employees: 6}, {Department: "Ph√≤ng K·∫ø to√°n", TotalRequests: 22, TotalDays: 66, AvgDays: 3.0, Employees: 7}, {Department: "Ban Gi√°m ƒë·ªëc", TotalRequests: 10, TotalDays: 40, AvgDays: 4.0, Employees: 4})); Set(varEmployeeStats, Table({Employee: "Nguy·ªÖn VƒÉn An", Department: "Ph√≤ng C√¥ng ngh·ªá th√¥ng tin", TotalRequests: 5, TotalDays: 15, RemainingDays: 9, UsageRate: 62.5}, {Employee: "Tr·∫ßn Th·ªã B√¨nh", Department: "Ph√≤ng C√¥ng ngh·ªá th√¥ng tin", TotalRequests: 4, TotalDays: 12, RemainingDays: 8, UsageRate: 60.0}, {Employee: "L√™ VƒÉn C∆∞·ªùng", Department: "Ban Gi√°m ƒë·ªëc", TotalRequests: 3, TotalDays: 18, RemainingDays: 12, UsageRate: 60.0}, {Employee: "Ph·∫°m Th·ªã Dung", Department: "Ban Gi√°m ƒë·ªëc", TotalRequests: 6, TotalDays: 22, RemainingDays: 8, UsageRate: 73.3})); Set(varIsExporting, false)
    Children:
      - 'Reports.Header':
          Control: HeaderComponent
          Properties:
            X: =0
            Y: =0
            Width: =Parent.Width
            Height: =80
            Title: ="B√°o c√°o ngh·ªâ ph√©p"
            UserName: =varCurrentUser.FullName
            UserRole: =varCurrentUser.Role
            ShowNotification: =true
            NotificationCount: =2
            
      - 'Reports.Navigation':
          Control: NavigationComponent
          Properties:
            X: =0
            Y: ='Reports.Header'.Y + 'Reports.Header'.Height
            Width: =250
            Height: =Parent.Height - 'Reports.Header'.Height
            UserRole: =varCurrentUser.Role
            ActiveScreen: =varActiveScreen
            OnNavigate: =Set(varNavigateAction, true)
            
      - 'Reports.Content.Container':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: ='Reports.Navigation'.X + 'Reports.Navigation'.Width
            Y: ='Reports.Header'.Y + 'Reports.Header'.Height
            Width: =Parent.Width - 'Reports.Navigation'.Width
            Height: =Parent.Height - 'Reports.Header'.Height
            Fill: =RGBA(248, 250, 252, 1)
          Children:
            - 'Reports.Content.Title':
                Control: Label
                Properties:
                  X: =Parent.X + 30
                  Y: =Parent.Y + 30
                  Width: =Parent.Width - 60
                  Height: =40
                  Text: ="Dashboard b√°o c√°o ngh·ªâ ph√©p"
                  Color: =RGBA(32, 54, 71, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Size: =24
                  
            - 'Reports.Controls.Container':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.X + 30
                  Y: ='Reports.Content.Title'.Y + 'Reports.Content.Title'.Height + 20
                  Width: =Parent.Width - 60
                  Height: =60
                  Fill: =RGBA(255, 255, 255, 1)
                  BorderColor: =RGBA(230, 230, 230, 1)
                  BorderThickness: =1
                  DropShadow: =DropShadow.Light
                Children:
                  - 'Reports.Period.Label':
                      Control: Label
                      Properties:
                        X: =Parent.X + 20
                        Y: =Parent.Y + 10
                        Width: =100
                        Height: =20
                        Text: ="K·ª≥ b√°o c√°o:"
                        Color: =RGBA(32, 54, 71, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =14
                        
                  - 'Reports.Period.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: =Parent.X + 20
                        Y: ='Reports.Period.Label'.Y + 'Reports.Period.Label'.Height + 5
                        Width: =120
                        Height: =35
                        Items: =["Month", "Quarter", "Year"]
                        Default: ="Month"
                        BorderColor: =RGBA(230, 230, 230, 1)
                        Font: =Font.'Open Sans'
                        Size: =12
                        OnChange: =Set(varReportPeriod, Self.Selected.Value)
                        
                  - 'Reports.Department.Label':
                      Control: Label
                      Properties:
                        X: ='Reports.Period.Dropdown'.X + 'Reports.Period.Dropdown'.Width + 30
                        Y: =Parent.Y + 10
                        Width: =100
                        Height: =20
                        Text: ="Ph√≤ng ban:"
                        Color: =RGBA(32, 54, 71, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =14
                        
                  - 'Reports.Department.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: ='Reports.Department.Label'.X
                        Y: ='Reports.Department.Label'.Y + 'Reports.Department.Label'.Height + 5
                        Width: =200
                        Height: =35
                        Items: =["All", "Ph√≤ng C√¥ng ngh·ªá th√¥ng tin", "Ph√≤ng Nh√¢n s·ª±", "Ph√≤ng K·∫ø to√°n", "Ban Gi√°m ƒë·ªëc"]
                        Default: ="All"
                        BorderColor: =RGBA(230, 230, 230, 1)
                        Font: =Font.'Open Sans'
                        Size: =12
                        OnChange: =Set(varSelectedDepartment, Self.Selected.Value)
                        
                  - 'Reports.Export.Button':
                      Control: Classic/Button
                      Properties:
                        X: =Parent.Width - Self.Width - 20
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =150
                        Height: =40
                        Text: =If(varIsExporting, "ƒêang xu·∫•t...", "üìä Xu·∫•t b√°o c√°o")
                        Fill: =RGBA(40, 167, 69, 1)
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =14
                        DisplayMode: =If(varIsExporting, DisplayMode.Disabled, DisplayMode.Edit)
                        OnSelect: =Set(varIsExporting, true); Notify("ƒêang xu·∫•t b√°o c√°o " & varReportPeriod & " cho " & If(varSelectedDepartment = "All", "t·∫•t c·∫£ ph√≤ng ban", varSelectedDepartment) & "...", NotificationType.Information); Set(varIsExporting, false); Notify("B√°o c√°o ƒë√£ ƒë∆∞·ª£c xu·∫•t th√†nh c√¥ng!", NotificationType.Success)
                          
            - 'Reports.Summary.Container':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.X + 30
                  Y: ='Reports.Controls.Container'.Y + 'Reports.Controls.Container'.Height + 20
                  Width: =Parent.Width - 60
                  Height: =120
                Children:
                  - 'Reports.Summary.TotalRequests':
                      Control: StatsCardComponent
                      Properties:
                        X: =Parent.X
                        Y: =Parent.Y
                        Width: =(Parent.Width - 60) / 4
                        Height: =Parent.Height
                        Title: ="T·ªïng ƒë∆°n ngh·ªâ ph√©p"
                        Value: =Sum(varMonthlyStats, TotalRequests)
                        Icon: ="Calendar"
                        Color: =RGBA(0, 120, 212, 1)
                        Subtitle: ="T·∫•t c·∫£ c√°c ƒë∆°n"
                        
                  - 'Reports.Summary.TotalDays':
                      Control: StatsCardComponent
                      Properties:
                        X: ='Reports.Summary.TotalRequests'.X + 'Reports.Summary.TotalRequests'.Width + 20
                        Y: =Parent.Y
                        Width: =(Parent.Width - 60) / 4
                        Height: =Parent.Height
                        Title: ="T·ªïng ng√†y ngh·ªâ"
                        Value: =Sum(varMonthlyStats, TotalDays)
                        Icon: ="Clock"
                        Color: =RGBA(255, 193, 7, 1)
                        Subtitle: ="Ng√†y ƒë√£ ngh·ªâ"
                        
                  - 'Reports.Summary.AvgDays':
                      Control: StatsCardComponent
                      Properties:
                        X: ='Reports.Summary.TotalDays'.X + 'Reports.Summary.TotalDays'.Width + 20
                        Y: =Parent.Y
                        Width: =(Parent.Width - 60) / 4
                        Height: =Parent.Height
                        Title: ="Trung b√¨nh/ƒë∆°n"
                        Value: =Round(Sum(varMonthlyStats, TotalDays) / Sum(varMonthlyStats, TotalRequests), 1)
                        Icon: ="People"
                        Color: =RGBA(40, 167, 69, 1)
                        Subtitle: ="Ng√†y/ƒë∆°n"
                        
                  - 'Reports.Summary.Employees':
                      Control: StatsCardComponent
                      Properties:
                        X: ='Reports.Summary.AvgDays'.X + 'Reports.Summary.AvgDays'.Width + 20
                        Y: =Parent.Y
                        Width: =(Parent.Width - 60) / 4
                        Height: =Parent.Height
                        Title: ="Nh√¢n vi√™n tham gia"
                        Value: =Max(varMonthlyStats, Employees)
                        Icon: ="People"
                        Color: =RGBA(108, 117, 125, 1)
                        Subtitle: ="Ng∆∞·ªùi"
                        
            - 'Reports.Charts.Container':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.X + 30
                  Y: ='Reports.Summary.Container'.Y + 'Reports.Summary.Container'.Height + 20
                  Width: =Parent.Width - 60
                  Height: =300
                Children:
                  - 'Reports.Chart.Monthly.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =Parent.X
                        Y: =Parent.Y
                        Width: =Parent.Width * 0.5 - 10
                        Height: =Parent.Height
                        Fill: =RGBA(255, 255, 255, 1)
                        BorderColor: =RGBA(230, 230, 230, 1)
                        BorderThickness: =1
                        DropShadow: =DropShadow.Light
                      Children:
                        - 'Reports.Chart.Monthly.Title':
                            Control: Label
                            Properties:
                              X: =Parent.X + 20
                              Y: =Parent.Y + 20
                              Width: =Parent.Width - 40
                              Height: =30
                              Text: ="Th·ªëng k√™ theo th√°ng"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =16
                              
                        - 'Reports.Chart.Monthly.Chart':
                            Control: BarChart
                            Properties:
                              X: =Parent.X + 20
                              Y: ='Reports.Chart.Monthly.Title'.Y + 'Reports.Chart.Monthly.Title'.Height + 10
                              Width: =Parent.Width - 40
                              Height: =Parent.Height - 80
                              Items: =varMonthlyStats
                              NumberOfSeries: =3
                              Series1: =TotalRequests
                              Series2: =ApprovedRequests
                              Series3: =RejectedRequests
                              XLabelAngle: =0
                              YAxisMin: =0
                              YAxisMax: =25
                              
                        - 'Reports.Chart.Monthly.Legend':
                            Control: Label
                            Properties:
                              X: =Parent.X + 20
                              Y: =Parent.Y + Parent.Height - 30
                              Width: =Parent.Width - 40
                              Height: =20
                              Text: ="üîµ T·ªïng ƒë∆°n  üü¢ ƒê√£ duy·ªát  üî¥ T·ª´ ch·ªëi"
                              Color: =RGBA(108, 117, 125, 1)
                              Font: =Font.'Open Sans'
                              Size: =10
                              Align: =Align.Center
                              
                  - 'Reports.Chart.Department.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: ='Reports.Chart.Monthly.Container'.X + 'Reports.Chart.Monthly.Container'.Width + 20
                        Y: =Parent.Y
                        Width: =Parent.Width * 0.5 - 10
                        Height: =Parent.Height
                        Fill: =RGBA(255, 255, 255, 1)
                        BorderColor: =RGBA(230, 230, 230, 1)
                        BorderThickness: =1
                        DropShadow: =DropShadow.Light
                      Children:
                        - 'Reports.Chart.Department.Title':
                            Control: Label
                            Properties:
                              X: =Parent.X + 20
                              Y: =Parent.Y + 20
                              Width: =Parent.Width - 40
                              Height: =30
                              Text: ="Th·ªëng k√™ theo ph√≤ng ban"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =16
                              
                        - 'Reports.Chart.Department.Chart':
                            Control: PieChart
                            Properties:
                              X: =Parent.X + 20
                              Y: ='Reports.Chart.Department.Title'.Y + 'Reports.Chart.Department.Title'.Height + 10
                              Width: =Parent.Width - 40
                              Height: =Parent.Height - 80
                              Items: =varDepartmentStats
                              Values: =TotalDays
                              Labels: =Department
                              
                        - 'Reports.Chart.Department.Legend':
                            Control: Label
                            Properties:
                              X: =Parent.X + 20
                              Y: =Parent.Y + Parent.Height - 30
                              Width: =Parent.Width - 40
                              Height: =20
                              Text: ="T·ªïng ng√†y ngh·ªâ theo ph√≤ng ban"
                              Color: =RGBA(108, 117, 125, 1)
                              Font: =Font.'Open Sans'
                              Size: =10
                              Align: =Align.Center
                              
            - 'Reports.Tables.Container':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.X + 30
                  Y: ='Reports.Charts.Container'.Y + 'Reports.Charts.Container'.Height + 20
                  Width: =Parent.Width - 60
                  Height: =Parent.Height - 580
                Children:
                  - 'Reports.Table.Department.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =Parent.X
                        Y: =Parent.Y
                        Width: =Parent.Width * 0.5 - 10
                        Height: =Parent.Height
                        Fill: =RGBA(255, 255, 255, 1)
                        BorderColor: =RGBA(230, 230, 230, 1)
                        BorderThickness: =1
                        DropShadow: =DropShadow.Light
                      Children:
                        - 'Reports.Table.Department.Title':
                            Control: Label
                            Properties:
                              X: =Parent.X + 20
                              Y: =Parent.Y + 20
                              Width: =Parent.Width - 40
                              Height: =30
                              Text: ="Chi ti·∫øt theo ph√≤ng ban"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =16
                              
                        - 'Reports.Table.Department.Gallery':
                            Control: Gallery
                            Variant: Vertical
                            Properties:
                              X: =Parent.X + 20
                              Y: ='Reports.Table.Department.Title'.Y + 'Reports.Table.Department.Title'.Height + 10
                              Width: =Parent.Width - 40
                              Height: =Parent.Height - 80
                              Items: =varDepartmentStats
                              TemplateSize: =60
                              TemplatePadding: =5
                            Children:
                              - 'Gallery.Department.Container':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.TemplateWidth
                                    Height: =Parent.TemplateHeight
                                    Fill: =RGBA(248, 249, 250, 1)
                                  Children:
                                    - 'Gallery.Department.Name':
                                        Control: Label
                                        Properties:
                                          X: =Parent.X + 15
                                          Y: =Parent.Y + 5
                                          Width: =Parent.Width - 30
                                          Height: =20
                                          Text: =ThisItem.Department
                                          Color: =RGBA(32, 54, 71, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Size: =12
                                          
                                    - 'Gallery.Department.Stats':
                                        Control: Label
                                        Properties:
                                          X: =Parent.X + 15
                                          Y: ='Gallery.Department.Name'.Y + 'Gallery.Department.Name'.Height + 2
                                          Width: =Parent.Width - 30
                                          Height: =25
                                          Text: =ThisItem.TotalRequests & " ƒë∆°n ‚Ä¢ " & ThisItem.TotalDays & " ng√†y ‚Ä¢ " & ThisItem.Employees & " ng∆∞·ªùi"
                                          Color: =RGBA(108, 117, 125, 1)
                                          Font: =Font.'Open Sans'
                                          Size: =10
                                          
                  - 'Reports.Table.Employee.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: ='Reports.Table.Department.Container'.X + 'Reports.Table.Department.Container'.Width + 20
                        Y: =Parent.Y
                        Width: =Parent.Width * 0.5 - 10
                        Height: =Parent.Height
                        Fill: =RGBA(255, 255, 255, 1)
                        BorderColor: =RGBA(230, 230, 230, 1)
                        BorderThickness: =1
                        DropShadow: =DropShadow.Light
                      Children:
                        - 'Reports.Table.Employee.Title':
                            Control: Label
                            Properties:
                              X: =Parent.X + 20
                              Y: =Parent.Y + 20
                              Width: =Parent.Width - 40
                              Height: =30
                              Text: ="Top nh√¢n vi√™n ngh·ªâ nhi·ªÅu"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =16
                              
                        - 'Reports.Table.Employee.Gallery':
                            Control: Gallery
                            Variant: Vertical
                            Properties:
                              X: =Parent.X + 20
                              Y: ='Reports.Table.Employee.Title'.Y + 'Reports.Table.Employee.Title'.Height + 10
                              Width: =Parent.Width - 40
                              Height: =Parent.Height - 80
                              Items: =SortByColumns(varEmployeeStats, "TotalDays", Descending)
                              TemplateSize: =60
                              TemplatePadding: =5
                            Children:
                              - 'Gallery.Employee.Container':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.TemplateWidth
                                    Height: =Parent.TemplateHeight
                                    Fill: =RGBA(248, 249, 250, 1)
                                  Children:
                                    - 'Gallery.Employee.Name':
                                        Control: Label
                                        Properties:
                                          X: =Parent.X + 15
                                          Y: =Parent.Y + 5
                                          Width: =Parent.Width - 80
                                          Height: =20
                                          Text: =ThisItem.Employee
                                          Color: =RGBA(32, 54, 71, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Size: =12
                                          
                                    - 'Gallery.Employee.Usage':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width - 60
                                          Y: =Parent.Y + 5
                                          Width: =50
                                          Height: =20
                                          Text: =Text(ThisItem.UsageRate, "0.0") & "%"
                                          Color: =If(ThisItem.UsageRate > 70, RGBA(220, 53, 69, 1), If(ThisItem.UsageRate > 50, RGBA(255, 193, 7, 1), RGBA(40, 167, 69, 1)))
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Bold
                                          Size: =12
                                          Align: =Align.Right
                                          
                                    - 'Gallery.Employee.Stats':
                                        Control: Label
                                        Properties:
                                          X: =Parent.X + 15
                                          Y: ='Gallery.Employee.Name'.Y + 'Gallery.Employee.Name'.Height + 2
                                          Width: =Parent.Width - 30
                                          Height: =25
                                          Text: =ThisItem.TotalDays & " ng√†y ngh·ªâ ‚Ä¢ " & ThisItem.RemainingDays & " ng√†y c√≤n l·∫°i"
                                          Color: =RGBA(108, 117, 125, 1)
                                          Font: =Font.'Open Sans'
                                          Size: =10 