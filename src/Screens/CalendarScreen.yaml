Screens:
  CalendarScreen:
    Properties:
      Fill: =RGBA(248, 250, 252, 1)
      OnVisible: |
        =Set(varActiveScreen, "Calendar");
        Set(varCurrentDate, Today());
        Set(varSelectedMonth, Month(Today()));
        Set(varSelectedYear, Year(Today()));
        Set(varCalendarView, "Personal");
        Set(varShowCalendarDetails, false);
        Set(varSelectedDateLeaves, Blank());
        Set(varPersonalLeaves, Filter(DonNghiPhep, MaNguoiDung.Value = UserSession.Id));
        Set(varAllLeaves, DonNghiPhep);
        Set(varDepartmentLeaves, Filter(DonNghiPhep, LookUp(NguoiDung, Title = MaNguoiDung.Value).MaDonVi.Value = LookUp(NguoiDung, Title = UserSession.Id).MaDonVi.Value));
        Set(varHolidays, NgayLe);
        Set(varMonthStart, DateAdd(Date(varSelectedYear, varSelectedMonth, 1), -(Weekday(Date(varSelectedYear, varSelectedMonth, 1), StartOfWeek.Sunday) - 1), Days));
        Set(varCalendarDays, Table());
        ForAll(Sequence(42), 
          Collect(varCalendarDays, {
            Date: DateAdd(varMonthStart, Value - 1, Days),
            IsCurrentMonth: Month(DateAdd(varMonthStart, Value - 1, Days)) = varSelectedMonth,
            IsToday: DateAdd(varMonthStart, Value - 1, Days) = Today(),
            IsWeekend: Weekday(DateAdd(varMonthStart, Value - 1, Days), StartOfWeek.Sunday) in [1, 7]
          })
        )
    Children:
      # Header Component
      - 'Calendar.Header':
          Control: CanvasComponent
          ComponentName: HeaderComponent
          Properties:
            X: =0
            Y: =0
            Width: =Parent.Width
            Height: =Parent.Height * 0.065
            UserName: =UserSession.HoTen
            UserRole: =UserSession.MaVaiTro
            ShowNotification: =true
            NotificationCount: =0
            OnLogout: |
              =Set(varIsUserAuthenticated, false);
              Set(UserSession, {
                Id: "", 
                Name: "", 
                Email: "", 
                Role: "", 
                Permission: 0,
                NguoiQuanLyId: "", 
                HoTen: "", 
                MaVaiTro: "", 
                ChucDanh: "", 
                MaDonVi: "", 
                TrangThai: ""
              });
              Navigate(LoginScreen)

      # Navigation Component
      - 'Calendar.Navigation':
          Control: CanvasComponent
          ComponentName: NavigationComponent
          Properties:
            X: =0
            Y: ='Calendar.Header'.Height
            Width: =If(varNavCollapsed, App.Width * 0.045, App.Width * 0.14)
            Height: =Parent.Height - 'Calendar.Header'.Height
            UserRole: =UserSession.MaVaiTro
            ActiveScreen: ="Calendar"
            IsCollapsed: =varNavCollapsed
            DashboardScreen: =DashboardScreen
            LeaveRequestScreen: =LeaveRequestScreen
            MyLeavesScreen: =MyLeavesScreen
            CalendarScreen: =CalendarScreen
            ManagementScreen: =ManagementScreen
            ProfileScreen: =ProfileScreen
            OnNavigate: |
              =Set(varActiveScreen, ScreenName);
              Switch(ScreenName,
                "Dashboard", Navigate(DashboardScreen),
                "LeaveRequest", Navigate(LeaveRequestScreen),
                "MyLeaves", Navigate(MyLeavesScreen),
                "Calendar", Navigate(CalendarScreen),
                "Management", Navigate(ManagementScreen),
                "Profile", Navigate(ProfileScreen),
                "Approval", Navigate(ApprovalScreen),
                "Reports", Navigate(ReportsScreen)
              )
            OnToggleCollapse: |
              =Set(varNavCollapsed, !varNavCollapsed)
              
      # Main Content Container
      - 'Calendar.Content.Container':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: ='Calendar.Navigation'.Width
            Y: ='Calendar.Header'.Height
            Width: =Parent.Width - 'Calendar.Navigation'.Width
            Height: =Parent.Height - 'Calendar.Header'.Height
          Children:
            - 'Calendar.Content.Padded':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.01
                  Y: =Parent.Height * 0.01
                  Width: =Parent.Width * 0.98
                  Height: =Parent.Height * 0.98
                Children:
                  # Page Header with Controls
                  - 'Calendar.PageHeader.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =0
                        Y: =0
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.15
                      Children:
                        - 'Calendar.PageHeader.Background':
                            Control: Rectangle
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Fill: =RGBA(255, 255, 255, 1)
                              BorderColor: =RGBA(226, 232, 240, 1)
                              BorderThickness: =1
                              
                        # Calendar Navigation
                        - 'Calendar.Nav.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =Parent.Width * 0.02
                              Y: =Parent.Height * 0.05
                              Width: =Parent.Width * 0.4
                              Height: =Parent.Height * 0.9
                            Children:
                              - 'Calendar.Nav.PrevButton':
                                  Control: CanvasComponent
                                  ComponentName: ButtonComponent
                                  Properties:
                                    X: =0
                                    Y: =(Parent.Height - Self.Height) / 2
                                    Width: =Parent.Width * 0.15
                                    Height: =Parent.Height * 0.6
                                    Text: ="‹"
                                    Variant: ="Outline"
                                    Size: ="Medium"
                                    OnClick: |
                                      =If(varSelectedMonth = 1,
                                        Set(varSelectedMonth, 12); Set(varSelectedYear, varSelectedYear - 1),
                                        Set(varSelectedMonth, varSelectedMonth - 1)
                                      );
                                      Set(varMonthStart, DateAdd(Date(varSelectedYear, varSelectedMonth, 1), -(Weekday(Date(varSelectedYear, varSelectedMonth, 1), StartOfWeek.Sunday) - 1), Days));
                                      Clear(varCalendarDays);
                                      ForAll(Sequence(42), 
                                        Collect(varCalendarDays, {
                                          Date: DateAdd(varMonthStart, Value - 1, Days),
                                          IsCurrentMonth: Month(DateAdd(varMonthStart, Value - 1, Days)) = varSelectedMonth,
                                          IsToday: DateAdd(varMonthStart, Value - 1, Days) = Today(),
                                          IsWeekend: Weekday(DateAdd(varMonthStart, Value - 1, Days), StartOfWeek.Sunday) in [1, 7]
                                        })
                                      )
                                      
                              - 'Calendar.Nav.MonthYear':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width * 0.2
                                    Y: =(Parent.Height - Self.Height) / 2
                                    Width: =Parent.Width * 0.6
                                    Height: =Parent.Height * 0.6
                                    Text: =Concatenate("Tháng ", varSelectedMonth, " năm ", varSelectedYear)
                                    Color: =RGBA(17, 24, 39, 1)
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Bold
                                    Size: =16
                                    Align: =Align.Center
                                    
                              - 'Calendar.Nav.NextButton':
                                  Control: CanvasComponent
                                  ComponentName: ButtonComponent
                                  Properties:
                                    X: =Parent.Width * 0.85
                                    Y: =(Parent.Height - Self.Height) / 2
                                    Width: =Parent.Width * 0.15
                                    Height: =Parent.Height * 0.6
                                    Text: ="›"
                                    Variant: ="Outline"
                                    Size: ="Medium"
                                    OnClick: |
                                      =If(varSelectedMonth = 12,
                                        Set(varSelectedMonth, 1); Set(varSelectedYear, varSelectedYear + 1),
                                        Set(varSelectedMonth, varSelectedMonth + 1)
                                      );
                                      Set(varMonthStart, DateAdd(Date(varSelectedYear, varSelectedMonth, 1), -(Weekday(Date(varSelectedYear, varSelectedMonth, 1), StartOfWeek.Sunday) - 1), Days));
                                      Clear(varCalendarDays);
                                      ForAll(Sequence(42), 
                                        Collect(varCalendarDays, {
                                          Date: DateAdd(varMonthStart, Value - 1, Days),
                                          IsCurrentMonth: Month(DateAdd(varMonthStart, Value - 1, Days)) = varSelectedMonth,
                                          IsToday: DateAdd(varMonthStart, Value - 1, Days) = Today(),
                                          IsWeekend: Weekday(DateAdd(varMonthStart, Value - 1, Days), StartOfWeek.Sunday) in [1, 7]
                                        })
                                      )

                        # View Selector
                        - 'Calendar.ViewSelector.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =Parent.Width * 0.45
                              Y: =Parent.Height * 0.05
                              Width: =Parent.Width * 0.53
                              Height: =Parent.Height * 0.9
                            Children:
                              - 'Calendar.ViewSelector.Label':
                                  Control: Label
                                  Properties:
                                    X: =0
                                    Y: =(Parent.Height - Self.Height) / 2
                                    Width: =Parent.Width * 0.2
                                    Height: =Parent.Height * 0.4
                                    Text: ="Hiển thị:"
                                    Color: =RGBA(55, 65, 81, 1)
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Semibold
                                    Size: =12
                                    
                              - 'Calendar.ViewSelector.Personal':
                                  Control: CanvasComponent
                                  ComponentName: ButtonComponent
                                  Properties:
                                    X: =Parent.Width * 0.22
                                    Y: =(Parent.Height - Self.Height) / 2
                                    Width: =Parent.Width * 0.24
                                    Height: =Parent.Height * 0.7
                                    Text: ="Cá nhân"
                                    Variant: =If(varCalendarView = "Personal", "Primary", "Outline")
                                    Size: ="Small"
                                    OnClick: |
                                      =Set(varCalendarView, "Personal")
                                      
                              - 'Calendar.ViewSelector.Department':
                                  Control: CanvasComponent
                                  ComponentName: ButtonComponent
                                  Properties:
                                    X: =Parent.Width * 0.47
                                    Y: =(Parent.Height - Self.Height) / 2
                                    Width: =Parent.Width * 0.24
                                    Height: =Parent.Height * 0.7
                                    Text: ="Phòng ban"
                                    Variant: =If(varCalendarView = "Department", "Primary", "Outline")
                                    Size: ="Small"
                                    OnClick: |
                                      =Set(varCalendarView, "Department")
                                      
                              - 'Calendar.ViewSelector.All':
                                  Control: CanvasComponent
                                  ComponentName: ButtonComponent
                                  Properties:
                                    X: =Parent.Width * 0.72
                                    Y: =(Parent.Height - Self.Height) / 2
                                    Width: =Parent.Width * 0.24
                                    Height: =Parent.Height * 0.7
                                    Text: ="Toàn công ty"
                                    Variant: =If(varCalendarView = "All", "Primary", "Outline")
                                    Size: ="Small"
                                    OnClick: |
                                      =Set(varCalendarView, "All")

                  # Calendar Grid
                  - 'Calendar.Grid.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =0
                        Y: ='Calendar.PageHeader.Container'.Y + 'Calendar.PageHeader.Container'.Height + Parent.Height * 0.01
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.82
                      Children:
                        - 'Calendar.Grid.Background':
                            Control: Rectangle
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Fill: =RGBA(255, 255, 255, 1)
                              BorderColor: =RGBA(226, 232, 240, 1)
                              BorderThickness: =1
                              
                        # Week Days Header
                        - 'Calendar.WeekDays.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =Parent.Width * 0.02
                              Y: =Parent.Height * 0.02
                              Width: =Parent.Width * 0.96
                              Height: =Parent.Height * 0.08
                            Children:
                              - 'Calendar.WeekDay.Sunday':
                                  Control: Label
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.Width / 7
                                    Height: =Parent.Height
                                    Text: ="CN"
                                    Color: =RGBA(239, 68, 68, 1)
                                    Fill: =RGBA(254, 242, 242, 1)
                                    BorderColor: =RGBA(226, 232, 240, 1)
                                    BorderThickness: =1
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Bold
                                    Size: =12
                                    Align: =Align.Center
                                    
                              - 'Calendar.WeekDay.Monday':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width / 7
                                    Y: =0
                                    Width: =Parent.Width / 7
                                    Height: =Parent.Height
                                    Text: ="T2"
                                    Color: =RGBA(55, 65, 81, 1)
                                    Fill: =RGBA(249, 250, 251, 1)
                                    BorderColor: =RGBA(226, 232, 240, 1)
                                    BorderThickness: =1
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Bold
                                    Size: =12
                                    Align: =Align.Center
                                    
                              - 'Calendar.WeekDay.Tuesday':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width / 7 * 2
                                    Y: =0
                                    Width: =Parent.Width / 7
                                    Height: =Parent.Height
                                    Text: ="T3"
                                    Color: =RGBA(55, 65, 81, 1)
                                    Fill: =RGBA(249, 250, 251, 1)
                                    BorderColor: =RGBA(226, 232, 240, 1)
                                    BorderThickness: =1
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Bold
                                    Size: =12
                                    Align: =Align.Center
                                    
                              - 'Calendar.WeekDay.Wednesday':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width / 7 * 3
                                    Y: =0
                                    Width: =Parent.Width / 7
                                    Height: =Parent.Height
                                    Text: ="T4"
                                    Color: =RGBA(55, 65, 81, 1)
                                    Fill: =RGBA(249, 250, 251, 1)
                                    BorderColor: =RGBA(226, 232, 240, 1)
                                    BorderThickness: =1
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Bold
                                    Size: =12
                                    Align: =Align.Center
                                    
                              - 'Calendar.WeekDay.Thursday':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width / 7 * 4
                                    Y: =0
                                    Width: =Parent.Width / 7
                                    Height: =Parent.Height
                                    Text: ="T5"
                                    Color: =RGBA(55, 65, 81, 1)
                                    Fill: =RGBA(249, 250, 251, 1)
                                    BorderColor: =RGBA(226, 232, 240, 1)
                                    BorderThickness: =1
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Bold
                                    Size: =12
                                    Align: =Align.Center
                                    
                              - 'Calendar.WeekDay.Friday':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width / 7 * 5
                                    Y: =0
                                    Width: =Parent.Width / 7
                                    Height: =Parent.Height
                                    Text: ="T6"
                                    Color: =RGBA(55, 65, 81, 1)
                                    Fill: =RGBA(249, 250, 251, 1)
                                    BorderColor: =RGBA(226, 232, 240, 1)
                                    BorderThickness: =1
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Bold
                                    Size: =12
                                    Align: =Align.Center
                                    
                              - 'Calendar.WeekDay.Saturday':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width / 7 * 6
                                    Y: =0
                                    Width: =Parent.Width / 7
                                    Height: =Parent.Height
                                    Text: ="T7"
                                    Color: =RGBA(239, 68, 68, 1)
                                    Fill: =RGBA(254, 242, 242, 1)
                                    BorderColor: =RGBA(226, 232, 240, 1)
                                    BorderThickness: =1
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Bold
                                    Size: =12
                                    Align: =Align.Center

                        # Calendar Days Grid
                        - 'Calendar.Days.Gallery':
                            Control: Gallery
                            Variant: VariableHeight
                            Properties:
                              X: =Parent.Width * 0.02
                              Y: ='Calendar.WeekDays.Container'.Y + 'Calendar.WeekDays.Container'.Height
                              Width: =Parent.Width * 0.96
                              Height: =Parent.Height * 0.88
                              Items: =varCalendarDays
                              TemplateSize: =Self.Height / 6
                              BorderThickness: =0
                              Fill: =RGBA(0, 0, 0, 0)
                            Children:
                              - 'Calendar.Day.Cell':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =(ThisItem.Date - varMonthStart) Mod 7 * (Parent.TemplateWidth / 7)
                                    Y: =Int((ThisItem.Date - varMonthStart) / 7) * Parent.TemplateSize
                                    Width: =Parent.TemplateWidth / 7
                                    Height: =Parent.TemplateSize
                                    Fill: =If(
                                      ThisItem.IsToday, RGBA(59, 130, 246, 0.1),
                                      If(ThisItem.IsWeekend, RGBA(254, 242, 242, 1),
                                        If(ThisItem.IsCurrentMonth, RGBA(255, 255, 255, 1), RGBA(249, 250, 251, 1))
                                      )
                                    )
                                    BorderColor: =RGBA(226, 232, 240, 1)
                                    BorderThickness: =1
                                    OnSelect: |
                                      =Set(varSelectedDateLeaves, 
                                        Switch(varCalendarView,
                                          "Personal", Filter(varPersonalLeaves, And(NgayBatDau <= ThisItem.Date, NgayKetThuc >= ThisItem.Date)),
                                          "Department", Filter(varDepartmentLeaves, And(NgayBatDau <= ThisItem.Date, NgayKetThuc >= ThisItem.Date)),
                                          "All", Filter(varAllLeaves, And(NgayBatDau <= ThisItem.Date, NgayKetThuc >= ThisItem.Date))
                                        )
                                      );
                                      Set(varShowCalendarDetails, true)
                                  Children:
                                    # Day Number
                                    - 'Calendar.Day.Number':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.05
                                          Y: =Parent.Height * 0.05
                                          Width: =Parent.Width * 0.3
                                          Height: =Parent.Height * 0.25
                                          Text: =Day(ThisItem.Date)
                                          Color: =If(
                                            ThisItem.IsToday, RGBA(59, 130, 246, 1),
                                            If(Not(ThisItem.IsCurrentMonth), RGBA(156, 163, 175, 1),
                                              If(ThisItem.IsWeekend, RGBA(239, 68, 68, 1), RGBA(17, 24, 39, 1))
                                            )
                                          )
                                          Font: =Font.'Open Sans'
                                          FontWeight: =If(ThisItem.IsToday, FontWeight.Bold, FontWeight.Normal)
                                          Size: =10
                                          
                                    # Holiday Indicator
                                    - 'Calendar.Day.Holiday':
                                        Control: Classic/Icon
                                        Properties:
                                          X: =Parent.Width * 0.7
                                          Y: =Parent.Height * 0.05
                                          Width: =Parent.Height * 0.2
                                          Height: =Parent.Height * 0.2
                                          Icon: =Icon.Star
                                          Color: =RGBA(251, 191, 36, 1)
                                          Visible: =CountRows(Filter(varHolidays, Ngay = Text(ThisItem.Date, "yyyy-mm-dd"))) > 0
                                          
                                    # Leave Events Container
                                    - 'Calendar.Day.Events':
                                        Control: GroupContainer
                                        Variant: ManualLayout
                                        Properties:
                                          X: =Parent.Width * 0.05
                                          Y: =Parent.Height * 0.35
                                          Width: =Parent.Width * 0.9
                                          Height: =Parent.Height * 0.6
                                        Children:
                                          # Personal Leave Indicator
                                          - 'Calendar.Day.PersonalLeave':
                                              Control: Rectangle
                                              Properties:
                                                X: =0
                                                Y: =0
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.3
                                                Fill: =RGBA(34, 197, 94, 0.7)
                                                BorderColor: =RGBA(34, 197, 94, 1)
                                                BorderThickness: =1
                                                Visible: =And(
                                                  varCalendarView = "Personal",
                                                  CountRows(Filter(varPersonalLeaves, And(NgayBatDau <= ThisItem.Date, NgayKetThuc >= ThisItem.Date))) > 0
                                                )
                                                
                                          # Department Leave Count
                                          - 'Calendar.Day.DepartmentCount':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =0
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.4
                                                Text: =CountRows(Filter(varDepartmentLeaves, And(NgayBatDau <= ThisItem.Date, NgayKetThuc >= ThisItem.Date))) & " người"
                                                Color: =RGBA(59, 130, 246, 1)
                                                Fill: =RGBA(219, 234, 254, 0.8)
                                                BorderColor: =RGBA(59, 130, 246, 1)
                                                BorderThickness: =1
                                                Font: =Font.'Open Sans'
                                                Size: =8
                                                Align: =Align.Center
                                                Visible: =And(
                                                  varCalendarView = "Department",
                                                  CountRows(Filter(varDepartmentLeaves, And(NgayBatDau <= ThisItem.Date, NgayKetThuc >= ThisItem.Date))) > 0
                                                )
                                                
                                          # All Company Leave Count
                                          - 'Calendar.Day.AllCount':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =0
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.4
                                                Text: =CountRows(Filter(varAllLeaves, And(NgayBatDau <= ThisItem.Date, NgayKetThuc >= ThisItem.Date))) & " người"
                                                Color: =RGBA(139, 69, 19, 1)
                                                Fill: =RGBA(254, 243, 199, 0.8)
                                                BorderColor: =RGBA(139, 69, 19, 1)
                                                BorderThickness: =1
                                                Font: =Font.'Open Sans'
                                                Size: =8
                                                Align: =Align.Center
                                                Visible: =And(
                                                  varCalendarView = "All",
                                                  CountRows(Filter(varAllLeaves, And(NgayBatDau <= ThisItem.Date, NgayKetThuc >= ThisItem.Date))) > 0
                                                )

      # Calendar Details Modal
      - 'Calendar.Details.Modal':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: =(Parent.Width - Parent.Width * 0.6) / 2
            Y: =(Parent.Height - Parent.Height * 0.7) / 2
            Width: =Parent.Width * 0.6
            Height: =Parent.Height * 0.7
            Fill: =RGBA(255, 255, 255, 1)
            BorderColor: =RGBA(226, 232, 240, 1)
            BorderThickness: =2
            Visible: =varShowCalendarDetails
          Children:
            - 'Calendar.Details.Header':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.02
                  Y: =Parent.Height * 0.02
                  Width: =Parent.Width * 0.96
                  Height: =Parent.Height * 0.08
                  Fill: =RGBA(59, 130, 246, 1)
                  BorderColor: =RGBA(37, 99, 235, 1)
                  BorderThickness: =1
                Children:
                  - 'Calendar.Details.Title':
                      Control: Label
                      Properties:
                        X: =Parent.Width * 0.03
                        Y: =(Parent.Height - Parent.Height * 0.6) / 2
                        Width: =Parent.Width * 0.8
                        Height: =Parent.Height * 0.6
                        Text: ="Chi tiết lịch nghỉ phép"
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =Parent.Height * 0.3
                        
                  - 'Calendar.Details.CloseButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.84
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.13
                        Height: =Parent.Height * 0.6
                        Text: ="Đóng"
                        Variant: ="Outline"
                        Size: ="Small"
                        OnClick: |
                          =Set(varShowCalendarDetails, false)
                        
            - 'Calendar.Details.Content':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.02
                  Y: ='Calendar.Details.Header'.Y + 'Calendar.Details.Header'.Height + Parent.Height * 0.02
                  Width: =Parent.Width * 0.96
                  Height: =Parent.Height * 0.86
                  BorderColor: =RGBA(226, 232, 240, 1)
                  BorderThickness: =1
                  Fill: =RGBA(255, 255, 255, 1)
                Children:
                  # Leave List Gallery
                  - 'Calendar.Details.LeaveList':
                      Control: Gallery
                      Variant: Vertical
                      Properties:
                        X: =Parent.Width * 0.02
                        Y: =Parent.Height * 0.02
                        Width: =Parent.Width * 0.96
                        Height: =Parent.Height * 0.96
                        Items: =varSelectedDateLeaves
                        TemplateSize: =Self.Height * 0.12
                        BorderThickness: =0
                        Fill: =RGBA(0, 0, 0, 0)
                      Children:
                        - 'Calendar.Details.LeaveItem':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.TemplateWidth
                              Height: =Parent.TemplateHeight
                              Fill: =If(Mod(ThisItem.Id, 2) = 0, RGBA(249, 250, 251, 1), RGBA(255, 255, 255, 1))
                              BorderColor: =RGBA(226, 232, 240, 1)
                              BorderThickness: =1
                            Children:
                              # Employee Name
                              - 'Calendar.Details.EmployeeName':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width * 0.02
                                    Y: =Parent.Height * 0.1
                                    Width: =Parent.Width * 0.25
                                    Height: =Parent.Height * 0.4
                                    Text: =LookUp(NguoiDung, Title = ThisItem.MaNguoiDung.Value).HoTen
                                    Color: =RGBA(17, 24, 39, 1)
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Semibold
                                    Size: =11
                                    
                              # Leave Period
                              - 'Calendar.Details.LeavePeriod':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width * 0.02
                                    Y: =Parent.Height * 0.55
                                    Width: =Parent.Width * 0.25
                                    Height: =Parent.Height * 0.35
                                    Text: =Text(ThisItem.NgayBatDau, "dd/mm") & " - " & Text(ThisItem.NgayKetThuc, "dd/mm")
                                    Color: =RGBA(75, 85, 99, 1)
                                    Font: =Font.'Open Sans'
                                    Size: =10
                                    
                              # Leave Type
                              - 'Calendar.Details.LeaveType':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width * 0.3
                                    Y: =Parent.Height * 0.1
                                    Width: =Parent.Width * 0.2
                                    Height: =Parent.Height * 0.4
                                    Text: =LookUp(LoaiNghi, MaLoai = ThisItem.MaLoai.Value).TenLoai
                                    Color: =RGBA(17, 24, 39, 1)
                                    Font: =Font.'Open Sans'
                                    Size: =11
                                    
                              # Days Count
                              - 'Calendar.Details.DaysCount':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width * 0.3
                                    Y: =Parent.Height * 0.55
                                    Width: =Parent.Width * 0.2
                                    Height: =Parent.Height * 0.35
                                    Text: =ThisItem.SoNgayNghi & " ngày"
                                    Color: =RGBA(75, 85, 99, 1)
                                    Font: =Font.'Open Sans'
                                    Size: =10
                                    
                              # Status
                              - 'Calendar.Details.Status':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width * 0.55
                                    Y: =(Parent.Height - Self.Height) / 2
                                    Width: =Parent.Width * 0.2
                                    Height: =Parent.Height * 0.6
                                    Text: =Switch(ThisItem.TrangThai.Value, 
                                      "ChoDuyetCap1", "Chờ duyệt",
                                      "ChoDuyetCap2", "Chờ duyệt", 
                                      "ChoDuyetCap3", "Chờ duyệt",
                                      "DaDuyet", "Đã duyệt",
                                      "TuChoi", "Từ chối",
                                      "Huy", "Đã hủy",
                                      ThisItem.TrangThai.Value)
                                    Color: =Switch(ThisItem.TrangThai.Value,
                                      "DaDuyet", RGBA(34, 197, 94, 1),
                                      "TuChoi", RGBA(239, 68, 68, 1),
                                      "Huy", RGBA(107, 114, 128, 1),
                                      RGBA(251, 191, 36, 1))
                                    Fill: =Switch(ThisItem.TrangThai.Value,
                                      "DaDuyet", RGBA(240, 253, 244, 1),
                                      "TuChoi", RGBA(254, 242, 242, 1),
                                      "Huy", RGBA(249, 250, 251, 1),
                                      RGBA(254, 243, 199, 1))
                                    BorderColor: =Switch(ThisItem.TrangThai.Value,
                                      "DaDuyet", RGBA(34, 197, 94, 1),
                                      "TuChoi", RGBA(239, 68, 68, 1),
                                      "Huy", RGBA(107, 114, 128, 1),
                                      RGBA(251, 191, 36, 1))
                                    BorderThickness: =1
                                    Font: =Font.'Open Sans'
                                    FontWeight: =FontWeight.Semibold
                                    Size: =10
                                    Align: =Align.Center
                                    
                              # Reason (partial)
                              - 'Calendar.Details.Reason':
                                  Control: Label
                                  Properties:
                                    X: =Parent.Width * 0.78
                                    Y: =(Parent.Height - Self.Height) / 2
                                    Width: =Parent.Width * 0.2
                                    Height: =Parent.Height * 0.8
                                    Text: =If(Len(ThisItem.LyDo) > 20, Left(ThisItem.LyDo, 17) & "...", ThisItem.LyDo)
                                    Color: =RGBA(75, 85, 99, 1)
                                    Font: =Font.'Open Sans'
                                    Size: =10
                                    Wrap: =true 
