Screens:
  CalendarScreen:
    Properties:
      Fill: =RGBA(248, 250, 252, 1)
      OnVisible: =Set(varActiveScreen, "Calendar"); Set(varSelectedMonth, Month(Today())); Set(varSelectedYear, Year(Today())); Set(varCalendarData, Table({Date: Date(2024,1,15), Type: "Nghỉ phép năm", Employee: "Nguyễn Văn An", Status: "Approved", Color: RGBA(40, 167, 69, 1)}, {Date: Date(2024,1,16), Type: "Nghỉ phép năm", Employee: "Nguyễn Văn An", Status: "Approved", Color: RGBA(40, 167, 69, 1)}, {Date: Date(2024,1,17), Type: "Nghỉ phép năm", Employee: "Nguyễn Văn An", Status: "Approved", Color: RGBA(40, 167, 69, 1)}, {Date: Date(2024,2,20), Type: "Nghỉ phép năm", Employee: "Trần Thị Bình", Status: "Pending", Color: RGBA(255, 193, 7, 1)}, {Date: Date(2024,2,21), Type: "Nghỉ phép năm", Employee: "Trần Thị Bình", Status: "Pending", Color: RGBA(255, 193, 7, 1)}, {Date: Date(2024,3,10), Type: "Nghỉ ốm", Employee: "Lê Văn Cường", Status: "Approved", Color: RGBA(40, 167, 69, 1)})); Set(varHolidays, Table({Date: Date(2024,1,1), Name: "Tết Dương lịch", Type: "Holiday"}, {Date: Date(2024,2,10), Name: "Tết Nguyên đán", Type: "Holiday"}, {Date: Date(2024,4,30), Name: "Ngày Giải phóng", Type: "Holiday"}, {Date: Date(2024,5,1), Name: "Ngày Quốc tế Lao động", Type: "Holiday"}, {Date: Date(2024,9,2), Name: "Ngày Quốc khánh", Type: "Holiday"})); Set(varViewMode, "Personal")
    Children:
      - 'Calendar.Header':
          Control: HeaderComponent
          Properties:
            X: =0
            Y: =0
            Width: =Parent.Width
            Height: =80
            Title: ="Lịch nghỉ phép"
            UserName: =varCurrentUser.FullName
            UserRole: =varCurrentUser.Role
            ShowNotification: =true
            NotificationCount: =2
            
      - 'Calendar.Navigation':
          Control: NavigationComponent
          Properties:
            X: =0
            Y: ='Calendar.Header'.Y + 'Calendar.Header'.Height
            Width: =250
            Height: =Parent.Height - 'Calendar.Header'.Height
            UserRole: =varCurrentUser.Role
            ActiveScreen: =varActiveScreen
            OnNavigate: =Set(varNavigateAction, true)
            
      - 'Calendar.Content.Container':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: ='Calendar.Navigation'.X + 'Calendar.Navigation'.Width
            Y: ='Calendar.Header'.Y + 'Calendar.Header'.Height
            Width: =Parent.Width - 'Calendar.Navigation'.Width
            Height: =Parent.Height - 'Calendar.Header'.Height
            Fill: =RGBA(248, 250, 252, 1)
          Children:
            - 'Calendar.Content.Title':
                Control: Label
                Properties:
                  X: =Parent.X + 30
                  Y: =Parent.Y + 30
                  Width: =Parent.Width - 60
                  Height: =40
                  Text: ="Lịch nghỉ phép"
                  Color: =RGBA(32, 54, 71, 1)
                  Font: =Font.'Open Sans'
                  FontWeight: =FontWeight.Bold
                  Size: =24
                  
            - 'Calendar.Controls.Container':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.X + 30
                  Y: ='Calendar.Content.Title'.Y + 'Calendar.Content.Title'.Height + 20
                  Width: =Parent.Width - 60
                  Height: =60
                  Fill: =RGBA(255, 255, 255, 1)
                  BorderColor: =RGBA(230, 230, 230, 1)
                  BorderThickness: =1
                  DropShadow: =DropShadow.Light
                Children:
                  - 'Calendar.ViewMode.Label':
                      Control: Label
                      Properties:
                        X: =Parent.X + 20
                        Y: =Parent.Y + 10
                        Width: =100
                        Height: =20
                        Text: ="Chế độ xem:"
                        Color: =RGBA(32, 54, 71, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =14
                        
                  - 'Calendar.ViewMode.Toggle':
                      Control: Classic/DropDown
                      Properties:
                        X: =Parent.X + 20
                        Y: ='Calendar.ViewMode.Label'.Y + 'Calendar.ViewMode.Label'.Height + 5
                        Width: =180
                        Height: =35
                        Items: =If(Or(varCurrentUser.Role = "Manager", varCurrentUser.Role = "Director", varCurrentUser.Role = "HR"), 
                          ["Cá nhân", "Toàn công ty"], 
                          ["Cá nhân"])
                        Default: ="Cá nhân"
                        BorderColor: =RGBA(230, 230, 230, 1)
                        Font: =Font.'Open Sans'
                        Size: =12
                        OnChange: =Set(varViewMode, If(Self.Selected.Value = "Cá nhân", "Personal", "Company"))
                        
                  - 'Calendar.MonthYear.Label':
                      Control: Label
                      Properties:
                        X: ='Calendar.ViewMode.Toggle'.X + 'Calendar.ViewMode.Toggle'.Width + 30
                        Y: =Parent.Y + 10
                        Width: =100
                        Height: =20
                        Text: ="Tháng/Năm:"
                        Color: =RGBA(32, 54, 71, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =14
                        
                  - 'Calendar.Month.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: ='Calendar.MonthYear.Label'.X
                        Y: ='Calendar.MonthYear.Label'.Y + 'Calendar.MonthYear.Label'.Height + 5
                        Width: =100
                        Height: =35
                        Items: =["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"]
                        Default: =Text(Month(Today()))
                        BorderColor: =RGBA(230, 230, 230, 1)
                        Font: =Font.'Open Sans'
                        Size: =12
                        OnChange: =Set(varSelectedMonth, Value(Self.Selected.Value))
                        
                  - 'Calendar.Year.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: ='Calendar.Month.Dropdown'.X + 'Calendar.Month.Dropdown'.Width + 10
                        Y: ='Calendar.Month.Dropdown'.Y
                        Width: =80
                        Height: =35
                        Items: =["2023", "2024", "2025"]
                        Default: =Text(Year(Today()))
                        BorderColor: =RGBA(230, 230, 230, 1)
                        Font: =Font.'Open Sans'
                        Size: =12
                        OnChange: =Set(varSelectedYear, Value(Self.Selected.Value))
                        
                  - 'Calendar.Legend.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =Parent.Width - Self.Width - 20
                        Y: =Parent.Y + 10
                        Width: =300
                        Height: =40
                      Children:
                        - 'Calendar.Legend.Title':
                            Control: Label
                            Properties:
                              X: =Parent.X
                              Y: =Parent.Y
                              Width: =60
                              Height: =20
                              Text: ="Chú thích:"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Semibold
                              Size: =12
                              
                        - 'Calendar.Legend.Approved':
                            Control: Rectangle
                            Properties:
                              X: =Parent.X + 70
                              Y: =Parent.Y + 2
                              Width: =15
                              Height: =15
                              Fill: =RGBA(40, 167, 69, 1)
                              
                        - 'Calendar.Legend.Approved.Label':
                            Control: Label
                            Properties:
                              X: ='Calendar.Legend.Approved'.X + 'Calendar.Legend.Approved'.Width + 5
                              Y: =Parent.Y
                              Width: =60
                              Height: =20
                              Text: ="Đã duyệt"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              Size: =10
                              
                        - 'Calendar.Legend.Pending':
                            Control: Rectangle
                            Properties:
                              X: ='Calendar.Legend.Approved.Label'.X + 'Calendar.Legend.Approved.Label'.Width + 10
                              Y: =Parent.Y + 2
                              Width: =15
                              Height: =15
                              Fill: =RGBA(255, 193, 7, 1)
                              
                        - 'Calendar.Legend.Pending.Label':
                            Control: Label
                            Properties:
                              X: ='Calendar.Legend.Pending'.X + 'Calendar.Legend.Pending'.Width + 5
                              Y: =Parent.Y
                              Width: =60
                              Height: =20
                              Text: ="Chờ duyệt"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              Size: =10
                              
                        - 'Calendar.Legend.Holiday':
                            Control: Rectangle
                            Properties:
                              X: ='Calendar.Legend.Pending.Label'.X + 'Calendar.Legend.Pending.Label'.Width + 10
                              Y: =Parent.Y + 2
                              Width: =15
                              Height: =15
                              Fill: =RGBA(220, 53, 69, 1)
                              
                        - 'Calendar.Legend.Holiday.Label':
                            Control: Label
                            Properties:
                              X: ='Calendar.Legend.Holiday'.X + 'Calendar.Legend.Holiday'.Width + 5
                              Y: =Parent.Y
                              Width: =40
                              Height: =20
                              Text: ="Ngày lễ"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              Size: =10
                              
            - 'Calendar.Main.Container':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.X + 30
                  Y: ='Calendar.Controls.Container'.Y + 'Calendar.Controls.Container'.Height + 20
                  Width: =Parent.Width - 60
                  Height: =Parent.Height - 180
                  Fill: =RGBA(255, 255, 255, 1)
                  BorderColor: =RGBA(230, 230, 230, 1)
                  BorderThickness: =1
                  DropShadow: =DropShadow.Light
                Children:
                  - 'Calendar.Header.Days':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =Parent.X + 20
                        Y: =Parent.Y + 20
                        Width: =Parent.Width - 40
                        Height: =40
                        Fill: =RGBA(248, 249, 250, 1)
                      Children:
                        - 'Calendar.Day.Mon':
                            Control: Label
                            Properties:
                              X: =Parent.X + (Parent.Width / 7) * 0
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width / 7
                              Height: =25
                              Text: ="T2"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =12
                              Align: =Align.Center
                              
                        - 'Calendar.Day.Tue':
                            Control: Label
                            Properties:
                              X: =Parent.X + (Parent.Width / 7) * 1
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width / 7
                              Height: =25
                              Text: ="T3"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =12
                              Align: =Align.Center
                              
                        - 'Calendar.Day.Wed':
                            Control: Label
                            Properties:
                              X: =Parent.X + (Parent.Width / 7) * 2
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width / 7
                              Height: =25
                              Text: ="T4"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =12
                              Align: =Align.Center
                              
                        - 'Calendar.Day.Thu':
                            Control: Label
                            Properties:
                              X: =Parent.X + (Parent.Width / 7) * 3
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width / 7
                              Height: =25
                              Text: ="T5"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =12
                              Align: =Align.Center
                              
                        - 'Calendar.Day.Fri':
                            Control: Label
                            Properties:
                              X: =Parent.X + (Parent.Width / 7) * 4
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width / 7
                              Height: =25
                              Text: ="T6"
                              Color: =RGBA(32, 54, 71, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =12
                              Align: =Align.Center
                              
                        - 'Calendar.Day.Sat':
                            Control: Label
                            Properties:
                              X: =Parent.X + (Parent.Width / 7) * 5
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width / 7
                              Height: =25
                              Text: ="T7"
                              Color: =RGBA(220, 53, 69, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =12
                              Align: =Align.Center
                              
                        - 'Calendar.Day.Sun':
                            Control: Label
                            Properties:
                              X: =Parent.X + (Parent.Width / 7) * 6
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width / 7
                              Height: =25
                              Text: ="CN"
                              Color: =RGBA(220, 53, 69, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =12
                              Align: =Align.Center
                              
                  - 'Calendar.Grid.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =Parent.X + 20
                        Y: ='Calendar.Header.Days'.Y + 'Calendar.Header.Days'.Height + 10
                        Width: =Parent.Width - 40
                        Height: =Parent.Height - 90
                      Children:
                        - 'Calendar.Grid.Info':
                            Control: Label
                            Properties:
                              X: =Parent.X
                              Y: =Parent.Y + 50
                              Width: =Parent.Width
                              Height: =100
                              Text: ="📅 Lịch nghỉ phép tháng " & varSelectedMonth & "/" & varSelectedYear & Char(10) & Char(10) & "Chế độ xem: " & If(varViewMode = "Personal", "Cá nhân", "Toàn công ty") & Char(10) & Char(10) & "💡 Tip: Chọn tháng/năm để xem lịch nghỉ phép chi tiết"
                              Color: =RGBA(108, 117, 125, 1)
                              Font: =Font.'Open Sans'
                              Size: =14
                              Align: =Align.Center
                              
                        - 'Calendar.Events.Gallery':
                            Control: Gallery
                            Variant: Vertical
                            Properties:
                              X: =Parent.X
                              Y: ='Calendar.Grid.Info'.Y + 'Calendar.Grid.Info'.Height + 20
                              Width: =Parent.Width
                              Height: =Parent.Height - 170
                              Items: =Filter(
                                If(varViewMode = "Personal", 
                                  Filter(varCalendarData, Employee = varCurrentUser.FullName),
                                  varCalendarData
                                ),
                                And(
                                  Month(Date) = varSelectedMonth,
                                  Year(Date) = varSelectedYear
                                )
                              )
                              TemplateSize: =60
                              TemplatePadding: =5
                            Children:
                              - 'Gallery.Event.Container':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.TemplateWidth
                                    Height: =Parent.TemplateHeight
                                    Fill: =ThisItem.Color
                                  Children:
                                    - 'Gallery.Event.Date':
                                        Control: Label
                                        Properties:
                                          X: =Parent.X + 15
                                          Y: =Parent.Y + 5
                                          Width: =80
                                          Height: =25
                                          Text: =Text(ThisItem.Date, "dd/mm")
                                          Color: =RGBA(255, 255, 255, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Bold
                                          Size: =14
                                          
                                    - 'Gallery.Event.Type':
                                        Control: Label
                                        Properties:
                                          X: ='Gallery.Event.Date'.X + 'Gallery.Event.Date'.Width + 20
                                          Y: =Parent.Y + 5
                                          Width: =200
                                          Height: =25
                                          Text: =ThisItem.Type
                                          Color: =RGBA(255, 255, 255, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Size: =12
                                          
                                    - 'Gallery.Event.Employee':
                                        Control: Label
                                        Properties:
                                          X: ='Gallery.Event.Date'.X
                                          Y: ='Gallery.Event.Date'.Y + 'Gallery.Event.Date'.Height
                                          Width: =300
                                          Height: =20
                                          Text: =If(varViewMode = "Company", ThisItem.Employee, "")
                                          Color: =RGBA(255, 255, 255, 0.8)
                                          Font: =Font.'Open Sans'
                                          Size: =10
                                          Visible: =varViewMode = "Company"
                                          
                                    - 'Gallery.Event.Status':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width - Self.Width - 15
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =80
                                          Height: =25
                                          Text: =Switch(ThisItem.Status,
                                            "Approved", "Đã duyệt",
                                            "Pending", "Chờ duyệt",
                                            "Rejected", "Từ chối",
                                            "Không xác định")
                                          Color: =RGBA(255, 255, 255, 1)
                                          Fill: =RGBA(255, 255, 255, 0.2)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Size: =10
                                          Align: =Align.Center