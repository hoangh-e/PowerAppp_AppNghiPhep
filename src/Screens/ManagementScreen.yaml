Screens:
  ManagementScreen:
    Properties:
      Fill: =RGBA(248, 250, 252, 1)
      OnVisible: |
        =Set(varActiveScreen, "Management"); 
        //Permission checks using inline bitwise expressions  
        Set(varUserPermissions, {
          ManageUsers: UserCanManageUsers,
          ManageRoles: UserCanManageRoles,
          ManageLeaveQuota: UserCanManageLeaveQuota,
          ManageHolidays: UserCanManageHolidays,
          ManageApprovalProcess: UserCanManageApprovalProcess,
          ExportReports: UserCanExportReports,
          SystemAdmin: UserCanSystemAdmin,
          ViewDashboard: UserCanViewDashboard
        });
        Set(varSelectedManagementTab, "Users");
        Set(varIsUserFormOpen, false);
        Set(varSelectedUser, Blank());
        Set(varIsEditingUser, false);
        Set(varUserFormName, "");
        Set(varUserFormEmail, "");
        Set(varUserFormPassword, "");
        Set(varUserFormRole, "");
        Set(varUserFormDepartment, "");
        Set(varUserFormStatus, "HoatDong");
        Set(varRecordSelected, false);
        Set(varSelectedUserRecord, Blank());
        Set(varSelectedLeaveBalanceRecord, {MaNguoiDung: "", Nam: 2024, TongNgayDuocPhep: 0, SoNgayDaNghi: 0, SoNgayConLai: 0});
        Set(varSelectedHolidayRecord, {MaNgayLe: 0, TenNgayLe: "", Ngay: "", Nam: 2024, Buoi: "CaNgay"});
        Set(varSelectedWorkflowRecord, {MaDonVi: "", Cap: "", MaVaiTro: "", NguoiDuyetMacDinh: "", DangHoatDong: false});
        Set(varSelectedHoliday, {MaNgayLe: 0, TenNgayLe: "", Ngay: "", Nam: 2024, Buoi: "CaNgay"});
        ClearCollect(colAllUsers, 
          {Title: "EMP001", HoTen: "Nguyễn Văn An", Email: "an.nguyen@company.com", 
           MatKhau: "123456", MaDonVi: "IT", MaVaiTro: "Employee", TrangThai: "HoatDong"},
          {Title: "EMP002", HoTen: "Trần Thị Bình", Email: "binh.tran@company.com", 
           MatKhau: "123456", MaDonVi: "HR", MaVaiTro: "Manager", TrangThai: "HoatDong"},
          {Title: "EMP003", HoTen: "Lê Hoàng Cường", Email: "cuong.le@company.com", 
           MatKhau: "123456", MaDonVi: "Finance", MaVaiTro: "Director", TrangThai: "HoatDong"},
          {Title: "EMP004", HoTen: "Phạm Thị Dung", Email: "dung.pham@company.com", 
           MatKhau: "123456", MaDonVi: "Marketing", MaVaiTro: "Director", TrangThai: "HoatDong"},
          {Title: "EMP005", HoTen: "Võ Minh Tuấn", Email: "tuan.vo@company.com", 
           MatKhau: "123456", MaDonVi: "IT", MaVaiTro: "Manager", TrangThai: "HoatDong"}
        );
        ClearCollect(colAllDepartments, 
          {MaDonVi: "IT", TenDonVi: "Phòng Công nghệ thông tin"},
          {MaDonVi: "HR", TenDonVi: "Phòng Nhân sự"},
          {MaDonVi: "Finance", TenDonVi: "Phòng Tài chính"},
          {MaDonVi: "Marketing", TenDonVi: "Phòng Marketing"}
        ); 
        ClearCollect(colAllRoles, 
          {MaVaiTro: "Employee", TenVaiTro: "Nhân viên"},
          {MaVaiTro: "Manager", TenVaiTro: "Quản lý"},
          {MaVaiTro: "Director", TenVaiTro: "Giám đốc"},
          {MaVaiTro: "HR", TenVaiTro: "Nhân sự"},
          {MaVaiTro: "Admin", TenVaiTro: "Quản trị viên"}
        );
        ClearCollect(colHolidaysList, 
          {MaNgayLe: 1, Ngay: "01/01", TenNgayLe: "Tết Dương lịch", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 2, Ngay: "08/02", TenNgayLe: "Tết Nguyên đán (28 Tết)", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 3, Ngay: "09/02", TenNgayLe: "Tết Nguyên đán (29 Tết 2024)", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 4, Ngay: "10/02", TenNgayLe: "Tết Nguyên đán (Mùng 1)", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 5, Ngay: "11/02", TenNgayLe: "Tết Nguyên đán (Mùng 2 2024)", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 6, Ngay: "12/02", TenNgayLe: "Tết Nguyên đán (Mùng 3 2024)", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 7, Ngay: "13/02", TenNgayLe: "Tết Nguyên đán (Mùng 4 2024)", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 8, Ngay: "14/02", TenNgayLe: "Tết Nguyên đán (Mùng 5 2024)", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 9, Ngay: "18/04", TenNgayLe: "Giỗ tổ Hùng Vương 2024", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 10, Ngay: "30/04", TenNgayLe: "Ngày Giải phóng miền Nam", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 11, Ngay: "01/05", TenNgayLe: "Ngày Quốc tế Lao động", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 12, Ngay: "02/09", TenNgayLe: "Ngày Quốc khánh", Nam: 2024, Buoi: "CaNgay"},
          {MaNgayLe: 13, Ngay: "03/09", TenNgayLe: "Ngày nghỉ bù Quốc khánh 2024", Nam: 2024, Buoi: "CaNgay"}
        );
        ClearCollect(colLeaveBalanceData, 
          {MaNguoiDung: "EMP001", Nam: 2024, TongNgayDuocPhep: 12, SoNgayDaNghi: 3, SoNgayConLai: 9},
          {MaNguoiDung: "EMP002", Nam: 2024, TongNgayDuocPhep: 15, SoNgayDaNghi: 5, SoNgayConLai: 10},
          {MaNguoiDung: "EMP003", Nam: 2024, TongNgayDuocPhep: 12, SoNgayDaNghi: 2, SoNgayConLai: 10}
        );
        ClearCollect(colWorkflowData, 
          {MaDonVi: "IT", Cap: "1", MaVaiTro: "Manager", NguoiDuyetMacDinh: "EMP005", DangHoatDong: true},
          {MaDonVi: "IT", Cap: "2", MaVaiTro: "Director", NguoiDuyetMacDinh: "EMP004", DangHoatDong: true},
          {MaDonVi: "IT", Cap: "3", MaVaiTro: "Director", NguoiDuyetMacDinh: "EMP003", DangHoatDong: true},
          {MaDonVi: "HR", Cap: "1", MaVaiTro: "Manager", NguoiDuyetMacDinh: "EMP002", DangHoatDong: true},
          {MaDonVi: "HR", Cap: "2", MaVaiTro: "Director", NguoiDuyetMacDinh: "EMP004", DangHoatDong: true},
          {MaDonVi: "HR", Cap: "3", MaVaiTro: "Director", NguoiDuyetMacDinh: "EMP003", DangHoatDong: true},
          {MaDonVi: "Finance", Cap: "1", MaVaiTro: "Manager", NguoiDuyetMacDinh: "EMP002", DangHoatDong: true},
          {MaDonVi: "Finance", Cap: "2", MaVaiTro: "Director", NguoiDuyetMacDinh: "EMP004", DangHoatDong: true},
          {MaDonVi: "Finance", Cap: "3", MaVaiTro: "Director", NguoiDuyetMacDinh: "EMP003", DangHoatDong: true},
          {MaDonVi: "Marketing", Cap: "1", MaVaiTro: "Manager", NguoiDuyetMacDinh: "EMP002", DangHoatDong: true},
          {MaDonVi: "Marketing", Cap: "2", MaVaiTro: "Director", NguoiDuyetMacDinh: "EMP004", DangHoatDong: true},
          {MaDonVi: "Marketing", Cap: "3", MaVaiTro: "Director", NguoiDuyetMacDinh: "EMP003", DangHoatDong: true}
        );
        Set(varShowImportModal, false);
        Set(varIsHolidayFormOpen, false);
        Set(varHolidayFormDate, Today());
        Set(varHolidayFormName, "");
        Set(varHolidayFormSession, "CaNgay");
        Set(varHolidayFormYear, Year(Today()));
        Set(varIsImporting, false);
        Set(varImportedDataCount, 0)
    Children:
      # Header Component
      - 'Management.Header':
          Control: CanvasComponent
          ComponentName: HeaderComponent
          Properties:
            X: =0
            Y: =0
            Width: =Parent.Width
            Height: =Parent.Height * 0.065
            UserName: =UserSession.HoTen
            UserRole: =UserSession.MaVaiTro
            ShowNotification: =true
            NotificationCount: =0
            OnLogout: |
              =Set(varIsUserAuthenticated, false);
              Set(UserSession, {
                Id: "", 
                Name: "", 
                Email: "", 
                Role: "", 
                Permission: 0,
                NguoiQuanLyId: "", 
                HoTen: "", 
                MaVaiTro: "", 
                ChucDanh: "", 
                MaDonVi: "", 
                TrangThai: ""
              });
              Navigate(LoginScreen)
            
      # Navigation Component
      - 'Management.Navigation':
          Control: CanvasComponent
          ComponentName: NavigationComponent
          Properties:
            X: =0
            Y: ='Management.Header'.Height
            Width: =If(varNavCollapsed, App.Width * 0.045, App.Width * 0.14)
            Height: =Parent.Height - 'Management.Header'.Height
            UserRole: =UserSession.MaVaiTro
            ActiveScreen: ="Management"
            IsCollapsed: =varNavCollapsed
            DashboardScreen: =DashboardScreen
            LeaveRequestScreen: =LeaveRequestScreen
            MyLeavesScreen: =MyLeavesScreen
            CalendarScreen: =CalendarScreen
            ManagementScreen: =ManagementScreen
            ReportsScreen: =ReportsScreen
            ProfileScreen: =ProfileScreen
            OnNavigate: |
              =Set(varActiveScreen, ScreenName);
              Switch(ScreenName,
                "Dashboard", Navigate(DashboardScreen),
                "LeaveRequest", Navigate(LeaveRequestScreen),
                "MyLeaves", Navigate(MyLeavesScreen),
                "Calendar", Navigate(CalendarScreen),
                "Management", Navigate(ManagementScreen),
                "Profile", Navigate(ProfileScreen),
                "Approval", Navigate(ApprovalScreen),
                "Reports", Navigate(ReportsScreen)
              )
            OnToggleCollapse: |
              =Set(varNavCollapsed, !varNavCollapsed)
            
      # Main Content Container
      - 'Management.Content.Container':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: ='Management.Navigation'.Width
            Y: ='Management.Header'.Height
            Width: =Parent.Width - 'Management.Navigation'.Width
            Height: =Parent.Height - 'Management.Header'.Height
          Children:
            - 'Management.Content.Padded':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.01
                  Y: =Parent.Height * 0.01
                  Width: =Parent.Width * 0.98
                  Height: =Parent.Height * 0.98
                Children:
                  # Page Header
                  - 'Management.PageHeader.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =0
                        Y: =0
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.1
                      Children:
                        - 'Management.PageHeader.Background':
                            Control: Rectangle
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Fill: =RGBA(255, 255, 255, 1)
                              BorderColor: =RGBA(226, 232, 240, 1)
                              BorderThickness: =1
                              
                        - 'Management.PageHeader.Icon':
                            Control: Classic/Icon
                            Properties:
                              X: =Parent.Width * 0.015
                              Y: =Parent.Height * 0.25
                              Width: =Parent.Height * 0.2
                              Height: =Parent.Height * 0.2
                              Icon: =Icon.Settings
                              Color: =RGBA(59, 130, 246, 1)
                              
                        - 'Management.PageHeader.Title':
                            Control: Label
                            Properties:
                              X: =Parent.Width * 0.015 + 'Management.PageHeader.Icon'.Width + Parent.Width * 0.01
                              Y: =Parent.Height * 0.2
                              Width: =Parent.Width * 0.6
                              Height: =Parent.Height * 0.35
                              Text: ="Quản lý hệ thống"
                              Color: =RGBA(17, 24, 39, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =FontSizes.Large
                        
                        - 'Management.PageHeader.Stats':
                            Control: Label
                            Properties:
                              X: =Parent.Width * 0.015 + 'Management.PageHeader.Icon'.Width + Parent.Width * 0.01
                              Y: =Parent.Height * 0.6
                              Width: =Parent.Width * 0.6
                              Height: =Parent.Height * 0.25
                              Text: ="Quản lý người dùng, ngày phép, lịch nghỉ lễ và quy trình"
                              Color: =RGBA(75, 85, 99, 1)
                              Font: =Font.'Open Sans'
                              Size: =FontSizes.Small

                  # Tab Navigation
                  - 'Management.Tabs.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =0
                        Y: ='Management.PageHeader.Container'.Y + 'Management.PageHeader.Container'.Height + Parent.Height * 0.015
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.08
                      Children:
                        - 'Management.Tabs.Background':
                            Control: Rectangle
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Fill: =RGBA(249, 250, 251, 1)
                              BorderColor: =RGBA(226, 232, 240, 1)
                              BorderThickness: =1
                              
                        - 'Management.Tabs.Users':
                            Control: CanvasComponent
                            ComponentName: ButtonComponent
                            Properties:
                              X: =Parent.Width * 0.02
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width * 0.15
                              Height: =Parent.Height * 0.7
                              Text: ="Người dùng"
                              Variant: =If(varSelectedManagementTab = "Users", "Primary", "Outline")
                              Size: =FontSizes.Small
                              OnClick: |
                                =Set(varSelectedManagementTab, "Users");
                                Set(varRecordSelected, false);
                                Set(varSelectedUserRecord, Blank())
                                      
                        - 'Management.Tabs.LeaveBalance':
                            Control: CanvasComponent
                            ComponentName: ButtonComponent
                            Properties:
                              X: =Parent.Width * 0.18
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width * 0.15
                              Height: =Parent.Height * 0.7
                              Text: ="Số ngày phép"
                              Variant: =If(varSelectedManagementTab = "LeaveBalance", "Primary", "Outline")
                              Size: =FontSizes.Small
                              OnClick: |
                                =Set(varSelectedManagementTab, "LeaveBalance");
                                Set(varRecordSelected, false);
                                Set(varSelectedUserRecord, Blank())
                                      
                        - 'Management.Tabs.Holidays':
                            Control: CanvasComponent
                            ComponentName: ButtonComponent
                            Properties:
                              X: =Parent.Width * 0.34
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width * 0.15
                              Height: =Parent.Height * 0.7
                              Text: ="Ngày nghỉ lễ"
                              Variant: =If(varSelectedManagementTab = "Holidays", "Primary", "Outline")
                              Size: =FontSizes.Small
                              OnClick: |
                                =Set(varSelectedManagementTab, "Holidays");
                                Set(varRecordSelected, false);
                                Set(varSelectedUserRecord, Blank())
                                      
                        - 'Management.Tabs.Workflow':
                            Control: CanvasComponent
                            ComponentName: ButtonComponent
                            Properties:
                              X: =Parent.Width * 0.5
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width * 0.15
                              Height: =Parent.Height * 0.7
                              Text: ="Quy trình"
                              Variant: =If(varSelectedManagementTab = "Workflow", "Primary", "Outline")
                              Size: =FontSizes.Small
                              OnClick: |
                                =Set(varSelectedManagementTab, "Workflow");
                                Set(varRecordSelected, false);
                                Set(varSelectedUserRecord, Blank())

                  # Tab Content Container
                  - 'Management.TabContent.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =0
                        Y: ='Management.Tabs.Container'.Y + 'Management.Tabs.Container'.Height + Parent.Height * 0.015
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.75
                      Children:
                        # ===== TAB NGƯỜI DÙNG =====
                        - 'Management.Users.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Visible: =varSelectedManagementTab = "Users"
                            Children:
                              # Users Header với nút Add
                              - 'Management.Users.Header':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.12
                                  Children:
                                    - 'Management.Users.Header.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(255, 255, 255, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    - 'Management.Users.Header.Title':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.5
                                          Height: =Parent.Height * 0.5
                                          Text: ="Danh sách người dùng (" & Text(CountRows(NguoiDung)) & " người)"
                                          Color: =RGBA(17, 24, 39, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Size: =FontSizes.Large

                                    - 'Management.Users.Header.SelectedInfo':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =Parent.Height * 0.7
                                          Width: =Parent.Width * 0.5
                                          Height: =Parent.Height * 0.25
                                          Text: =If(varRecordSelected, 
                                            "Đã chọn:" & varSelectedUserRecord.HoTen & " (" & varSelectedUserRecord.Email & ")",
                                            "Chưa chọn người dùng nào")
                                          Color: =If(varRecordSelected, RGBA(59, 130, 246, 1), RGBA(107, 114, 128, 1))
                                          Font: =Font.'Open Sans'
                                          FontWeight: =If(varRecordSelected, FontWeight.Semibold, FontWeight.Normal)
                                          Size: =FontSizes.Small

                                    - 'Management.Users.AddButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.54
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.12
                                          Height: =Parent.Height * 0.6
                                          Text: ="Thêm"
                                          Variant: ="Primary"
                                          Size: =FontSizes.Medium
                                          OnClick: |
                                            =Set(varIsEditingUser, false);
                                            Set(varSelectedUser, Blank());
                                            Set(varUserFormName, "");
                                            Set(varUserFormEmail, "");
                                            Set(varUserFormPassword, "");
                                            Set(varUserFormRole, "");
                                            Set(varUserFormDepartment, "");
                                            Set(varUserFormStatus, "HoatDong");
                                            Set(varRecordSelected, false);
                                            Set(varSelectedUserRecord, Blank());
                                            Set(varIsUserFormOpen, true)

                                    - 'Management.Users.EditButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.67
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.1
                                          Height: =Parent.Height * 0.6
                                          Text: ="Sửa"
                                          Variant: =If(varRecordSelected, "Primary", "Disabled")
                                          Size: =FontSizes.Medium
                                          OnClick: |
                                            =If(varRecordSelected,
                                              Set(varIsEditingUser, true);
                                              Set(varSelectedUser, varSelectedUserRecord);
                                              Set(varUserFormName, varSelectedUserRecord.HoTen);
                                              Set(varUserFormEmail, varSelectedUserRecord.Email);
                                              Set(varUserFormDepartment, "");
                                              Set(varUserFormRole, "");
                                              Set(varUserFormStatus, If(Not(IsBlank(varSelectedUserRecord.TrangThai.Value)), varSelectedUserRecord.TrangThai.Value, "HoatDong"));
                                              Set(varIsUserFormOpen, true),
                                              Notify("Vui lòng chọn một người dùng để chỉnh sửa", NotificationType.Warning)
                                            )

                                    - 'Management.Users.DeleteButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.78
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.09
                                          Height: =Parent.Height * 0.6
                                          Text: ="Xóa"
                                          Variant: =If(varRecordSelected, "Outline", "Disabled")
                                          Size: =FontSizes.Medium
                                          OnClick: |
                                            =If(varRecordSelected,
                                              If(varSelectedUserRecord.Title = UserSession.Id,
                                                Notify("Không thể xóa tài khoản của chính mình", NotificationType.Error),
                                                ClearCollect(colAllUsers, Filter(colAllUsers, Title <> varSelectedUserRecord.Title));
                                                Set(varRecordSelected, false);
                                                Set(varSelectedUserRecord, Blank());
                                                Notify("Đã xóa người dùng thành công", NotificationType.Success)
                                              ),
                                              Notify("Vui lòng chọn một người dùng để xóa", NotificationType.Warning)
                                            )

                                    - 'Management.Users.RefreshButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.88
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.1
                                          Height: =Parent.Height * 0.6
                                          Text: ="Làm mới"
                                          Variant: ="Outline"
                                          Size: =FontSizes.Medium
                                          OnClick: |
                                            =Refresh(NguoiDung);
                                            Refresh(DonVi);
                                            Refresh(VaiTro);
                                            Set(varRecordSelected, false);
                                            Set(varSelectedUserRecord, Blank());
                                            Notify("Đã làm mới dữ liệu", NotificationType.Success)

                        # ===== TAB SỐ NGÀY PHÉP =====
                        - 'Management.LeaveBalance.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Visible: =varSelectedManagementTab = "LeaveBalance"
                            Children:
                              # LeaveBalance Header - Optimized Layout
                              - 'Management.LeaveBalance.Header':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.12
                                  Children:
                                    - 'Management.LeaveBalance.Header.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(255, 255, 255, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    # Main Title - Left Side (35%)
                                    - 'Management.LeaveBalance.Header.Title':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.35
                                          Height: =Parent.Height * 0.6
                                          Text: ="Quản lý số ngày nghỉ phép"
                                          Color: =RGBA(17, 24, 39, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Bold
                                          Size: =FontSizes.Large
                                          VerticalAlign: =VerticalAlign.Middle

                                    # Subtitle with count
                                    - 'Management.LeaveBalance.Header.Subtitle':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =Parent.Height * 0.7
                                          Width: =Parent.Width * 0.35
                                          Height: =Parent.Height * 0.25
                                          Text: =Concatenate("Năm ", Year(Today()), " - ", CountRows(SoNgayPhep), " nhân viên")
                                          Color: =RGBA(107, 114, 128, 1)
                                          Font: =Font.'Open Sans'
                                          Size: =FontSizes.Small

                                    # Template Button - Center (20%)
                                    - 'Management.LeaveBalance.TemplateButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.4
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.2
                                          Height: =Parent.Height * 0.5
                                          Text: ="Xem template"
                                          Variant: ="Outline"
                                          Size: =FontSizes.Small
                                          OnClick: |
                                            =Launch("https://cmmspronet.sharepoint.com/:x:/s/PMQLNP/EZJjRDPQHg5JqpwY6N1wchQBW9myTx__boa2PVcTWA3NcQ?e=16pqk1")

                                    # Import Button - Right Side (25%)
                                    - 'Management.LeaveBalance.ImportButton':
                                        Control: Import
                                        Properties:
                                          X: =Parent.Width * 0.62
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.25
                                          Height: =Parent.Height * 0.5
                                          Text: ="Import số ngày phép"
                                          BorderColor: =ColorFade(RGBA(34, 197, 94, 1), -15%)
                                          Color: =RGBA(255, 255, 255, 1)
                                          Fill: =RGBA(34, 197, 94, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Size: =FontSizes.Small
                                          HoverBorderColor: =ColorFade(RGBA(34, 197, 94, 1), 20%)
                                          HoverColor: =RGBA(255, 255, 255, 1)
                                          HoverFill: =ColorFade(RGBA(34, 197, 94, 1), -20%)
                                          PressedBorderColor: =ColorFade(RGBA(34, 197, 94, 1), -20%)
                                          PressedFill: =ColorFade(RGBA(34, 197, 94, 1), -20%)
                                          OnSelect: |
                                            =Set(varIsImporting, true);
                                            Notify("Đang import dữ liệu số ngày nghỉ phép từ file Excel. Vui lòng chờ trong giây lát...", NotificationType.Information);
                                            Set(varImportedDataCount, Rand() * 10 + 5);
                                            If(varImportedDataCount > 0,
                                              Notify("Import thành công! Đã cập nhật số ngày phép cho " & Text(Round(varImportedDataCount, 0)) & " nhân viên. Email thông báo sẽ được gửi đến tất cả nhân viên.", NotificationType.Success),
                                              Notify("Import thất bại hoặc không có dữ liệu. Vui lòng kiểm tra lại file template.", NotificationType.Error)
                                            );
                                            Set(varIsImporting, false)

                                    # Help Button - Far Right (10%)
                                    - 'Management.LeaveBalance.HelpButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.89
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.09
                                          Height: =Parent.Height * 0.5
                                          Text: ="?"
                                          Variant: ="Ghost"
                                          Size: =FontSizes.Small
                                          OnClick: |
                                            =Notify("Hướng dẫn: 1) Click 'Xem template' để tải file mẫu. 2) Điền đúng định dạng: MaNhanVien, HoTen, Email, TongNgayPhep, Nam. 3) Click 'Import' để tải file đã hoàn thiện.", NotificationType.Information)

                        # ===== TAB NGÀY NGHỈ LỄ =====
                        - 'Management.Holidays.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Visible: =varSelectedManagementTab = "Holidays"
                            Children:
                              # Holidays Header
                              - 'Management.Holidays.Header':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.12
                                  Children:
                                    - 'Management.Holidays.Header.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(255, 255, 255, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    - 'Management.Holidays.Header.Title':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.6
                                          Height: =Parent.Height * 0.5
                                          Text: ="Danh sách ngày nghỉ lễ (" & Text(CountRows(NgayLe)) & " ngày)"
                                          Color: =RGBA(17, 24, 39, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Bold
                                          Size: =FontSizes.Large

                                    - 'Management.Holidays.AddButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.75
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.22
                                          Height: =Parent.Height * 0.6
                                          Text: ="Thêm ngày lễ"
                                          Variant: ="Primary"
                                          Size: =FontSizes.Medium
                                          OnClick: |
                                            =Set(varSelectedHoliday, {MaNgayLe: 0, TenNgayLe: "", Ngay: "", Nam: 2024, Buoi: "CaNgay"});
                                            Set(varHolidayFormName, "");
                                            Set(varHolidayFormDate, Today());
                                            Set(varIsHolidayFormOpen, true)

                        # ===== TAB QUY TRÌNH =====
                        - 'Management.Workflow.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Visible: =varSelectedManagementTab = "Workflow"
                            Children:
                              # Workflow Header
                              - 'Management.Workflow.Header':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.15
                                  Children:
                                    - 'Management.Workflow.Header.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(255, 255, 255, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    - 'Management.Workflow.Header.Title':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =Parent.Height * 0.1
                                          Width: =Parent.Width * 0.96
                                          Height: =Parent.Height * 0.3
                                          Text: ="Quy trình phê duyệt 3 cấp"
                                          Color: =RGBA(17, 24, 39, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Bold
                                          Size: =FontSizes.Large

                                    - 'Management.Workflow.Header.Description':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =Parent.Height * 0.5
                                          Width: =Parent.Width * 0.96
                                          Height: =Parent.Height * 0.4
                                          Text: ="Thiết lập người phê duyệt cho từng cấp theo đơn vị. Chỉ có thể thay đổi khi không có đơn nào đang chờ phê duyệt."
                                          Color: =RGBA(75, 85, 99, 1)
                                          Font: =Font.'Open Sans'
                                          Size: =FontSizes.Small

                              # Workflow Process Diagram
                              - 'Management.Workflow.Process':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: ='Management.Workflow.Header'.Y + 'Management.Workflow.Header'.Height + Parent.Height * 0.02
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.4
                                  Children:
                                    - 'Management.Workflow.Process.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(249, 250, 251, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    # Step 1
                                    - 'Management.Workflow.Step1':
                                        Control: GroupContainer
                                        Variant: ManualLayout
                                        Properties:
                                          X: =Parent.Width * 0.05
                                          Y: =Parent.Height * 0.2
                                          Width: =Parent.Width * 0.25
                                          Height: =Parent.Height * 0.6
                                        Children:
                                          - 'Management.Workflow.Step1.Background':
                                              Control: Rectangle
                                              Properties:
                                                X: =0
                                                Y: =0
                                                Width: =Parent.Width
                                                Height: =Parent.Height
                                                Fill: =RGBA(59, 130, 246, 0.1)
                                                BorderColor: =RGBA(59, 130, 246, 1)
                                                BorderThickness: =2

                                          - 'Management.Workflow.Step1.Title':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.1
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.3
                                                Text: ="CẤP 1"
                                                Color: =RGBA(59, 130, 246, 1)
                                                Font: =Font.'Open Sans'
                                                FontWeight: =FontWeight.Bold
                                                Size: =FontSizes.Base
                                                Align: =Align.Center

                                          - 'Management.Workflow.Step1.Role':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.45
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.45
                                                Text: ="Trưởng nhóm/Trưởng phòng"
                                                Color: =RGBA(17, 24, 39, 1)
                                                Font: =Font.'Open Sans'
                                                Size: =FontSizes.Small
                                                Align: =Align.Center
                                                Wrap: =true

                                    # Arrow 1
                                    - 'Management.Workflow.Arrow1':
                                        Control: Classic/Icon
                                        Properties:
                                          X: =Parent.Width * 0.32
                                          Y: =Parent.Height * 0.45
                                          Width: =Parent.Width * 0.04
                                          Height: =Parent.Height * 0.1
                                          Icon: =Icon.ChevronRight
                                          Color: =RGBA(75, 85, 99, 1)

                                    # Step 2
                                    - 'Management.Workflow.Step2':
                                        Control: GroupContainer
                                        Variant: ManualLayout
                                        Properties:
                                          X: =Parent.Width * 0.38
                                          Y: =Parent.Height * 0.2
                                          Width: =Parent.Width * 0.25
                                          Height: =Parent.Height * 0.6
                                        Children:
                                          - 'Management.Workflow.Step2.Background':
                                              Control: Rectangle
                                              Properties:
                                                X: =0
                                                Y: =0
                                                Width: =Parent.Width
                                                Height: =Parent.Height
                                                Fill: =RGBA(251, 191, 36, 0.1)
                                                BorderColor: =RGBA(251, 191, 36, 1)
                                                BorderThickness: =2

                                          - 'Management.Workflow.Step2.Title':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.1
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.3
                                                Text: ="CẤP 2"
                                                Color: =RGBA(251, 191, 36, 1)
                                                Font: =Font.'Open Sans'
                                                FontWeight: =FontWeight.Bold
                                                Size: =FontSizes.Base
                                                Align: =Align.Center

                                          - 'Management.Workflow.Step2.Role':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.45
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.45
                                                Text: ="Giám đốc khối"
                                                Color: =RGBA(17, 24, 39, 1)
                                                Font: =Font.'Open Sans'
                                                Size: =FontSizes.Small
                                                Align: =Align.Center

                                    # Arrow 2
                                    - 'Management.Workflow.Arrow2':
                                        Control: Classic/Icon
                                        Properties:
                                          X: =Parent.Width * 0.65
                                          Y: =Parent.Height * 0.45
                                          Width: =Parent.Width * 0.04
                                          Height: =Parent.Height * 0.1
                                          Icon: =Icon.ChevronRight
                                          Color: =RGBA(75, 85, 99, 1)

                                    # Step 3
                                    - 'Management.Workflow.Step3':
                                        Control: GroupContainer
                                        Variant: ManualLayout
                                        Properties:
                                          X: =Parent.Width * 0.71
                                          Y: =Parent.Height * 0.2
                                          Width: =Parent.Width * 0.25
                                          Height: =Parent.Height * 0.6
                                        Children:
                                          - 'Management.Workflow.Step3.Background':
                                              Control: Rectangle
                                              Properties:
                                                X: =0
                                                Y: =0
                                                Width: =Parent.Width
                                                Height: =Parent.Height
                                                Fill: =RGBA(239, 68, 68, 0.1)
                                                BorderColor: =RGBA(239, 68, 68, 1)
                                                BorderThickness: =2

                                          - 'Management.Workflow.Step3.Title':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.1
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.3
                                                Text: ="CẤP 3"
                                                Color: =RGBA(239, 68, 68, 1)
                                                Font: =Font.'Open Sans'
                                                FontWeight: =FontWeight.Bold
                                                Size: =FontSizes.Base
                                                Align: =Align.Center

                                          - 'Management.Workflow.Step3.Role':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.45
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.45
                                                Text: ="Giám đốc điều hành"
                                                Color: =RGBA(17, 24, 39, 1)
                                                Font: =Font.'Open Sans'
                                                Size: =FontSizes.Small
                                                Align: =Align.Center

      # Users DataTable
      - 'Management.Users.DataTable':
          Control: DataTable
          Properties:
            BorderColor: =RGBA(203, 213, 225, 1)
            BorderThickness: =2
            Color: =RGBA(15, 23, 42, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Font: =Font.'Open Sans'
            HeadingColor: =RGBA(255, 255, 255, 1)
            HeadingFill: =RGBA(30, 58, 138, 1)
            HeadingFont: =Font.'Open Sans'
            HeadingFontWeight: =FontWeight.Bold
            HeadingSize: =FontSizes.Small
            Height: ='Management.Users.Container'.Height + ('Management.Content.Padded'.Height - Self.Y - 'Management.Users.Container'.Height)
            HoverFill: =RGBA(241, 245, 249, 1)
            Items: =NguoiDung
            NoDataText: ="Không có dữ liệu người dùng"
            Size: =FontSizes.Base
            Visible: =varSelectedManagementTab = "Users"
            Width: ='Management.Content.Padded'.Width
            X: ='Management.Navigation'.Width + 'Management.Content.Padded'.X
            Y: ='Management.Content.Container'.Y + 'Management.Content.Padded'.Y + 'Management.TabContent.Container'.Y + 'Management.Users.Header'.Height
          Children:
            - UserName_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Họ tên"
                  FieldName: ="HoTen"
                  Order: =1
                  Text: =ThisItem.HoTen
                  Width: =Parent.Width * 0.18
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - UserEmail_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Email"
                  FieldName: ="Email"
                  Order: =2
                  Text: =ThisItem.Email
                  Width: =Parent.Width * 0.22
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - 'Users.MaDonVi: TenDonVi_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: |-
                    ="MaDonVi: TenDonVi"
                  FieldName: ="MaDonVi_x003a__x0020_TenDonVi"
                  Order: =3
                  Text: |-
                    =ThisItem.'MaDonVi: TenDonVi'.Value
                  Width: =Parent.Width * 0.16
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - UserPosition_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Chức danh"
                  FieldName: ="ChucDanh"
                  Order: =4
                  Text: =If(Not(IsBlank(ThisItem.ChucDanh.Value)), 
                    Switch(ThisItem.ChucDanh.Value,
                      "Nhân viên", "Nhân viên",
                      "Giám đốc khối", "Giám đốc khối", 
                      "Giám đốc điều hành", "Giám đốc điều hành",
                      "Chuyên viên", "Chuyên viên",
                      "Trưởng phòng", "Trưởng phòng",
                      ThisItem.ChucDanh.Value),
                    "Chưa cập nhật")
                  Width: =Parent.Width * 0.14
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - 'Users.MaVaiTro: TenVaiTro_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Vai trò"
                  FieldName: ="MaVaiTro_x003a__x0020_TenVaiTro"
                  Order: =5
                  Text: |-
                    =ThisItem.'MaVaiTro: TenVaiTro'.Value
                  Width: =Parent.Width * 0.12
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - UserStatus_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Trạng thái"
                  FieldName: ="TrangThai"
                  Order: =6
                  Text: =If(Not(IsBlank(ThisItem.TrangThai.Value)),
                    Switch(ThisItem.TrangThai.Value,
                      "HoatDong", "Hoạt động",
                      "KhongHoatDong", "Không hoạt động",
                      ThisItem.TrangThai.Value),
                    "Chưa cập nhật")
                  Width: =Parent.Width * 0.11
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

      # LeaveBalance DataTable
      - 'Management.LeaveBalance.DataTable':
          Control: DataTable
          Properties:
            BorderColor: =RGBA(203, 213, 225, 1)
            BorderThickness: =2
            Color: =RGBA(15, 23, 42, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Font: =Font.'Open Sans'
            HeadingColor: =RGBA(255, 255, 255, 1)
            HeadingFill: =RGBA(5, 150, 105, 1)
            HeadingFont: =Font.'Open Sans'
            HeadingFontWeight: =FontWeight.Bold
            HeadingSize: =FontSizes.Small
            Height: ='Management.LeaveBalance.Container'.Height + ('Management.Content.Padded'.Height - Self.Y - 'Management.LeaveBalance.Container'.Height)
            HoverFill: =RGBA(240, 253, 244, 1)
            Items: =SoNgayPhep
            NoDataText: ="Không có dữ liệu số ngày phép"
            Size: =FontSizes.Base
            Visible: =varSelectedManagementTab = "LeaveBalance"
            Width: ='Management.Content.Padded'.Width
            X: ='Management.Navigation'.Width + 'Management.Content.Padded'.X
            Y: ='Management.Content.Container'.Y + 'Management.Content.Padded'.Y + 'Management.TabContent.Container'.Y + 'Management.LeaveBalance.Header'.Height
          Children:
            # Essential columns only
            - 'MaNguoiDung: HoTen_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Nhân viên"
                  FieldName: ="MaNguoiDung_x003a__x0020_HoTen"
                  Order: =1
                  Text: |
                    =ThisItem.'MaNguoiDung: HoTen'.Value
                  Width: =Parent.Width * 0.25

            - Nam_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Năm"
                  FieldName: ="Nam"
                  Order: =2
                  Text: =ThisItem.Nam
                  Width: =Parent.Width * 0.08

            - TongNgayDuocPhep_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Tổng ngày phép"
                  FieldName: ="TongNgayDuocPhep"
                  Order: =3
                  Text: =ThisItem.TongNgayDuocPhep
                  Width: =Parent.Width * 0.15

            - SoNgayDaNghi_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Đã nghỉ"
                  FieldName: ="SoNgayDaNghi"
                  Order: =4
                  Text: =ThisItem.SoNgayDaNghi
                  Width: =Parent.Width * 0.12

            - SoNgayConLai_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Còn lại"
                  FieldName: ="SoNgayConLai"
                  Order: =5
                  Text: =ThisItem.SoNgayConLai
                  Width: =Parent.Width * 0.12

            - SoNgayKhongLuong_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Không lương"
                  FieldName: ="SoNgayKhongLuong"
                  Order: =6
                  Text: =ThisItem.SoNgayKhongLuong
                  Width: =Parent.Width * 0.13

      # Holidays DataTable
      - 'Management.Holidays.DataTable':
          Control: DataTable
          Properties:
            BorderColor: =RGBA(203, 213, 225, 1)
            BorderThickness: =2
            Color: =RGBA(15, 23, 42, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Font: =Font.'Open Sans'
            HeadingColor: =RGBA(255, 255, 255, 1)
            HeadingFill: =RGBA(217, 119, 6, 1)
            HeadingFont: =Font.'Open Sans'
            HeadingFontWeight: =FontWeight.Bold
            Height: ='Management.Holidays.Container'.Height + ('Management.Content.Padded'.Height - Self.Y - 'Management.Holidays.Container'.Height)
            HoverFill: =RGBA(255, 251, 235, 1)
            Items: =NgayLe
            NoDataText: ="Không có dữ liệu ngày nghỉ lễ. Vui lòng thêm ngày lễ mới."
            Size: =FontSizes.Base
            Visible: =varSelectedManagementTab = "Holidays"
            Width: ='Management.Content.Padded'.Width
            X: ='Management.Navigation'.Width + 'Management.Content.Padded'.X
            Y: ='Management.Content.Container'.Y + 'Management.Content.Padded'.Y + 'Management.TabContent.Container'.Y + 'Management.Holidays.Header'.Height
          Children:
            - Ngay_Column2:
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Ngày"
                  FieldName: ="TenNgayLe"
                  Order: =2
                  Text: =ThisItem.Ngay
            - Buoi_Column2:
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Buổi"
                  FieldName: ="Buoi"
                  Order: =3
                  Text: =ThisItem.Buoi.Value
            - Nam_Column3:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Năm"
                  FieldName: ="Nam"
                  Order: =4
                  Text: ="20" & ThisItem.Nam
            - MaNgayLe_Column2:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  AutoWidth: =false
                  FieldDisplayName: ="MaNgayLe"
                  FieldName: ="MaNgayLe"
                  Order: =1
                  Text: =ThisItem.MaNgayLe
            - TenNgayLe_Column2:
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  AutoWidth: =false
                  FieldDisplayName: ="Tên ngày lễ"
                  FieldName: ="TenNgayLe0"
                  Order: =1
                  Text: =ThisItem.'TenNgayLe (TenNgayLe0)'
                  Width: ='Ngay_Column2'.Width *1.4

      # Workflow DataTable
      - 'Management.Workflow.DataTable':
          Control: DataTable
          Properties:
            BorderColor: =RGBA(203, 213, 225, 1)
            BorderThickness: =2
            Color: =RGBA(15, 23, 42, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Font: =Font.'Open Sans'
            HeadingColor: =RGBA(255, 255, 255, 1)
            HeadingFill: =RGBA(126, 34, 206, 1)
            HeadingFont: =Font.'Open Sans'
            HeadingFontWeight: =FontWeight.Bold
            HeadingSize: =FontSizes.Small
            Height: ='Management.Workflow.Container'.Height + ('Management.Content.Padded'.Height - Self.Y - 'Management.Workflow.Container'.Height)
            HoverFill: =RGBA(250, 245, 255, 1)
            Items: =QuyTrinhDuyet
            NoDataText: ="Không có dữ liệu quy trình duyệt"
            Size: =FontSizes.Base
            Visible: =varSelectedManagementTab = "Workflow"
            Width: ='Management.Content.Padded'.Width
            X: ='Management.Navigation'.Width + 'Management.Content.Padded'.X
            Y: ='Management.Content.Container'.Y + 'Management.Content.Padded'.Y + 'Management.TabContent.Container'.Y + 'Management.Workflow.Process'.Y + 'Management.Workflow.Process'.Height
          Children:
            # Essential workflow columns only
            - 'Workflow.MaDonVi: TenDonVi_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Đơn vị"
                  FieldName: ="MaDonVi_x003a__x0020_TenDonVi"
                  Order: =1
                  Text: |
                    =ThisItem.'MaDonVi: TenDonVi'.Value
                  Width: =Parent.Width * 0.22

            - Cap_Column:
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Cấp duyệt"
                  FieldName: ="Cap"
                  Order: =2
                  Text: |
                    =Switch(ThisItem.Cap.Value,
                      "1", "Cấp 1",
                      "2", "Cấp 2", 
                      "3", "Cấp 3",
                      "Không xác định")
                  Width: =Parent.Width * 0.15

            - 'Workflow.MaVaiTro: TenVaiTro_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Vai trò"
                  FieldName: ="MaVaiTro_x003a__x0020_TenVaiTro"
                  Order: =3
                  Text: |
                    =ThisItem.'MaVaiTro: TenVaiTro'.Value
                  Width: =Parent.Width * 0.18

            - 'NguoiDuyetMacDinh: HoTen_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Người duyệt mặc định"
                  FieldName: ="NguoiDuyetMacDinh_x003a__x0020_H"
                  Order: =4
                  Text: |
                    =ThisItem.'NguoiDuyetMacDinh_x003a__x0020_H'.Value
                  Width: =Parent.Width * 0.25

            - DangHoatDong_Column:
                Control: DataTableColumn
                Variant: Boolean
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Trạng thái"
                  FieldName: ="DangHoatDong"
                  Order: =5
                  Text: |
                    =If(ThisItem.DangHoatDong, "Hoạt động", "Không hoạt động")
                  Width: =Parent.Width * 0.15

      # ===== MODAL FORMS (TOP LAYER - Z-INDEX) =====
      
      # Import Modal
      - 'Management.Import.Modal':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: =(Parent.Width - Self.Width) / 2
            Y: =(Parent.Height - Self.Height) / 2
            Width: =Parent.Width * 0.6
            Height: =Parent.Height * 0.6
            Fill: =RGBA(255, 255, 255, 1)
            BorderColor: =RGBA(226, 232, 240, 1)
            BorderThickness: =2
            Visible: =varShowImportModal
          Children:
            # Import Header
            - 'Management.Import.Header':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =0
                  Y: =0
                  Width: =Parent.Width
                  Height: =Parent.Height * 0.15
                  Fill: =RGBA(34, 197, 94, 1)
                Children:
                  - 'Management.Import.Title':
                      Control: Label
                      Properties:
                        X: =Parent.Width * 0.05
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.7
                        Height: =Parent.Height * 0.6
                        Text: ="Import số ngày nghỉ phép từ Excel"
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =FontSizes.Large

                  - 'Management.Import.CloseButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.85
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.12
                        Height: =Parent.Height * 0.6
                        Text: ="Đóng"
                        Variant: ="Outline"
                        Size: =FontSizes.Small
                        OnClick: |
                          =Set(varShowImportModal, false)

            # Import Instructions
            - 'Management.Import.Instructions':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: ='Management.Import.Header'.Height + Parent.Height * 0.03
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.6
                Children:
                  - 'Management.Import.Instructions.Title':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =0
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.15
                        Text: ="Hướng dẫn import file Excel:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =FontSizes.Small

                  - 'Management.Import.Instructions.Content':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.2
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.6
                        Text: |
                          =Concatenate(
                          "File Excel cần có các cột sau:", Char(10),
                          "• Mã Nhân viên", Char(10),
                          "• Họ và tên", Char(10),
                          "• Email", Char(10),
                          "• Tổng ngày phép", Char(10),
                          "• Năm", Char(10), Char(10),
                          "Lưu ý:File phải ở định dạng .xlsx hoặc .csv"
                          )
                        Color: =RGBA(75, 85, 99, 1)
                        Font: =Font.'Open Sans'
                        Size: =FontSizes.Small
                        Wrap: =true

                  - 'Management.Import.FileUpload':
                      Control: AddMedia
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.85
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.12
                        Text: ="Chọn file Excel"
                        BorderColor: =RGBA(59, 130, 246, 1)
                        BorderThickness: =2
                        Color: =RGBA(59, 130, 246, 1)
                        Fill: =RGBA(239, 246, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

            # Import Actions
            - 'Management.Import.Actions':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: =Parent.Height * 0.85
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.12
                Children:
                  - 'Management.Import.ProcessButton':
                      Control: Import
                      Properties:
                        X: =0
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: ="Xử lý import"
                        BorderColor: =ColorFade(RGBA(34, 197, 94, 1), -15%)
                        Color: =RGBA(255, 255, 255, 1)
                        Fill: =RGBA(34, 197, 94, 1)
                        Font: =Font.'Open Sans'
                        HoverBorderColor: =ColorFade(RGBA(34, 197, 94, 1), 20%)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(34, 197, 94, 1), -20%)
                        PressedBorderColor: =ColorFade(RGBA(34, 197, 94, 1), -20%)
                        PressedFill: =ColorFade(RGBA(34, 197, 94, 1), -20%)
                        OnSelect: |
                          =Set(varImportedDataCount, Rand() * 8 + 3);
                          Notify("Đã import thành công " & Text(Round(varImportedDataCount, 0)) & " bản ghi dữ liệu số ngày nghỉ phép từ file Excel vào hệ thống", NotificationType.Success);
                          Set(varShowImportModal, false)

                  - 'Management.Import.CancelButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.55
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: ="Hủy"
                        Variant: ="Outline"
                        Size: =FontSizes.Medium
                        OnClick: |
                          =Set(varShowImportModal, false)

      # User Form Modal
      - 'Management.UserForm.Modal':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: =(Parent.Width - Self.Width) / 2
            Y: =(Parent.Height - Self.Height) / 2
            Width: =Parent.Width * 0.5
            Height: =Parent.Height * 0.7
            Fill: =RGBA(255, 255, 255, 1)
            BorderColor: =RGBA(226, 232, 240, 1)
            BorderThickness: =2
            Visible: =varIsUserFormOpen
          Children:
            # Form Header
            - 'Management.UserForm.Header':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =0
                  Y: =0
                  Width: =Parent.Width
                  Height: =Parent.Height * 0.15
                  Fill: =RGBA(59, 130, 246, 1)
                Children:
                  - 'Management.UserForm.Title':
                      Control: Label
                      Properties:
                        X: =Parent.Width * 0.05
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.7
                        Height: =Parent.Height * 0.6
                        Text: =If(varIsEditingUser, "Chỉnh sửa người dùng", "Thêm người dùng mới")
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =FontSizes.Large

                  - 'Management.UserForm.CloseButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.85
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.12
                        Height: =Parent.Height * 0.6
                        Text: ="Đóng"
                        Variant: ="Outline"
                        Size: =FontSizes.Small
                        OnClick: |
                          =Set(varIsUserFormOpen, false)

            # Form Content
            - 'Management.UserForm.Content':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: ='Management.UserForm.Header'.Height + Parent.Height * 0.03
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.65
                Children:
                  # Name Field
                  - 'Management.UserForm.Name.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =0
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Họ và tên:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.UserForm.Name.Input':
                      Control: Classic/TextInput
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =0
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Default: =varUserFormName
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =FontSizes.Base
                        OnChange: |
                          =Set(varUserFormName, Self.Text)

                  # Email Field
                  - 'Management.UserForm.Email.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.15
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Email:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.UserForm.Email.Input':
                      Control: Classic/TextInput
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.15
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Default: =varUserFormEmail
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =FontSizes.Base
                        OnChange: |
                          =Set(varUserFormEmail, Self.Text)

                  # Password Field
                  - 'Management.UserForm.Password.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.25
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Mật khẩu:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.UserForm.Password.Input':
                      Control: Classic/TextInput
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.25
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Default: =varUserFormPassword
                        Mode: =TextMode.Password
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =FontSizes.Base
                        OnChange: |
                          =Set(varUserFormPassword, Self.Text)

                  # Department Field
                  - 'Management.UserForm.Department.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.35
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Đơn vị:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.UserForm.Department.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.35
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Items: =["IT", "HR", "Finance", "Marketing", "Operations"]
                        Default: =varUserFormDepartment
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        OnChange: |
                          =Set(varUserFormDepartment, Self.Selected.Value)

                  # Role Field
                  - 'Management.UserForm.Role.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.5
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Vai trò:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.UserForm.Role.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.5
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Items: =["Employee", "Manager", "Director", "HR", "Admin"]
                        Default: =varUserFormRole
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        OnChange: |
                          =Set(varUserFormRole, Self.Selected.Value)

                  # Status Field
                  - 'Management.UserForm.Status.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.65
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Trạng thái:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.UserForm.Status.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.65
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Items: =["HoatDong", "KhongHoatDong"]
                        Default: =If(IsBlank(varUserFormStatus), 
                          "HoatDong",
                          varUserFormStatus)
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        OnChange: |
                          =Set(varUserFormStatus, Self.Selected.Value)

            # Form Actions
            - 'Management.UserForm.Actions':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: =Parent.Height * 0.85
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.12
                Children:
                  - 'Management.UserForm.SaveButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =0
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: =If(varIsEditingUser, "Cập nhật", "Thêm mới")
                        Variant: ="Primary"
                        Size: =FontSizes.Medium
                        OnClick: |
                          =If(varIsEditingUser,
                            Notify(Concatenate("Cập nhật thành công: ", varUserFormName), NotificationType.Success),
                            Notify(Concatenate("Thêm thành công: ", varUserFormName), NotificationType.Success)
                          );
                          If(varIsEditingUser,
                            ClearCollect(colAllUsers, 
                              ForAll(colAllUsers, 
                                If(Title = varSelectedUser.Title,
                                  {Title: Title, HoTen: varUserFormName, Email: varUserFormEmail, 
                                   MatKhau: varUserFormPassword, MaDonVi: varUserFormDepartment, MaVaiTro: varUserFormRole, TrangThai: varUserFormStatus},
                                  ThisRecord))),
                            Collect(colAllUsers, 
                              {Title: "EMP" & Text(CountRows(colAllUsers) + 1, "000"), 
                               HoTen: varUserFormName, Email: varUserFormEmail,
                               MatKhau: varUserFormPassword, MaDonVi: varUserFormDepartment, MaVaiTro: varUserFormRole, TrangThai: varUserFormStatus})
                          );
                          Set(varIsUserFormOpen, false)

                  - 'Management.UserForm.CancelButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.55
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: ="Hủy"
                        Variant: ="Outline"
                        Size: =FontSizes.Medium
                        OnClick: |
                          =Set(varIsUserFormOpen, false)

      # Holiday Form Modal
      - 'Management.HolidayForm.Modal':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: =(Parent.Width - Self.Width) / 2
            Y: =(Parent.Height - Self.Height) / 2
            Width: =Parent.Width * 0.5
            Height: =Parent.Height * 0.6
            Fill: =RGBA(255, 255, 255, 1)
            BorderColor: =RGBA(226, 232, 240, 1)
            BorderThickness: =2
            Visible: =varIsHolidayFormOpen
          Children:
            # Form Header
            - 'Management.HolidayForm.Header':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =0
                  Y: =0
                  Width: =Parent.Width
                  Height: =Parent.Height * 0.15
                  Fill: =RGBA(217, 119, 6, 1)
                Children:
                  - 'Management.HolidayForm.Title':
                      Control: Label
                      Properties:
                        X: =Parent.Width * 0.05
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.7
                        Height: =Parent.Height * 0.6
                        Text: ="Thêm ngày nghỉ lễ mới"
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =FontSizes.Large

                  - 'Management.HolidayForm.CloseButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.85
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.12
                        Height: =Parent.Height * 0.6
                        Text: ="Đóng"
                        Variant: ="Outline"
                        Size: =FontSizes.Small
                        OnClick: |
                          =Set(varIsHolidayFormOpen, false)

            # Form Content
            - 'Management.HolidayForm.Content':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: ='Management.HolidayForm.Header'.Height + Parent.Height * 0.03
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.65
                Children:
                  # Holiday Name Field
                  - 'Management.HolidayForm.Name.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =0
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.12
                        Text: ="Tên ngày lễ:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.HolidayForm.Name.Input':
                      Control: Classic/TextInput
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =0
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.1
                        Default: =varHolidayFormName
                        HintText: ="Nhập tên ngày lễ"
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =FontSizes.Base
                        OnChange: |
                          =Set(varHolidayFormName, Self.Text)

                  # Date Field
                  - 'Management.HolidayForm.Date.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.18
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.12
                        Text: ="Ngày:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.HolidayForm.Date.Picker':
                      Control: Classic/DatePicker
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.18
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.1
                        DefaultDate: =varHolidayFormDate
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =FontSizes.Base
                        OnChange: |
                          =Set(varHolidayFormDate, Self.SelectedDate)

                  # Session Field
                  - 'Management.HolidayForm.Session.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.36
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.12
                        Text: ="Buổi:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.HolidayForm.Session.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.36
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.1
                        Items: =["CaNgay", "Sang", "Chieu"]
                        Default: ="CaNgay"
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        OnChange: |
                          =Set(varHolidayFormSession, Self.Selected.Value)

                  # Year Field
                  - 'Management.HolidayForm.Year.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.54
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.12
                        Text: ="Năm:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =FontSizes.Base

                  - 'Management.HolidayForm.Year.Input':
                      Control: Classic/TextInput
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.54
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.1
                        Default: =Text(Year(Today()))
                        HintText: ="Nhập năm (ví dụ:2024)"
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =FontSizes.Base
                        OnChange: |
                          =Set(varHolidayFormYear, Value(Self.Text))

            # Form Actions
            - 'Management.HolidayForm.Actions':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: =Parent.Height * 0.85
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.12
                Children:
                  - 'Management.HolidayForm.SaveButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =0
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: ="Thêm ngày lễ"
                        Variant: ="Primary"
                        Size: =FontSizes.Medium
                        OnClick: |
                          =If(And(Not(IsBlank(varHolidayFormName)), Not(IsBlank(varHolidayFormDate))),
                            Notify("Thêm ngày nghỉ lễ thành công: " & varHolidayFormName, NotificationType.Success);
                            Set(varIsHolidayFormOpen, false);
                            Set(varHolidayFormName, "");
                            Set(varHolidayFormDate, Today()),
                            Notify("Vui lòng điền đầy đủ thông tin ngày nghỉ lễ", NotificationType.Warning)
                          )

                  - 'Management.HolidayForm.CancelButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.55
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: ="Hủy"
                        Variant: ="Outline"
                        Size: =FontSizes.Medium
                        OnClick: |
                          =Set(varIsHolidayFormOpen, false)
