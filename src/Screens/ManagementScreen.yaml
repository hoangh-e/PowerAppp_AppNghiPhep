Screens:
  ManagementScreen:
    Properties:
      Fill: =RGBA(248, 250, 252, 1)
      OnVisible: |
        =Set(varActiveScreen, "Management"); 
        Set(varSelectedManagementTab, "Users");
        Set(varIsUserFormOpen, false);
        Set(varSelectedUser, Blank());
        Set(varIsEditingUser, false);
        Set(varUserFormName, "");
        Set(varUserFormEmail, "");
        Set(varUserFormRole, "");
        Set(varUserFormDepartment, "");
        Set(varUserFormStatus, "HoatDong");
        Set(varRecordSelected, false);
        Set(varSelectedUserRecord, Blank());
        Set(varSelectedLeaveBalanceRecord, Blank());
        Set(varSelectedHolidayRecord, Blank());
        Set(varSelectedWorkflowRecord, Blank());
        // Demo data for preview when SharePoint not available - using flat structure
        Set(varAllUsers, If(IsEmpty(NguoiDung), 
          Table(
            {Title: "EMP001", HoTen: "Nguyễn Văn An", Email: "an.nguyen@company.com", 
             MaDonVi: "IT", MaVaiTro: "Employee", TrangThai: "HoatDong"},
            {Title: "EMP002", HoTen: "Trần Thị Bình", Email: "binh.tran@company.com", 
             MaDonVi: "HR", MaVaiTro: "Manager", TrangThai: "HoatDong"},
            {Title: "EMP003", HoTen: "Lê Hoàng Cường", Email: "cuong.le@company.com", 
             MaDonVi: "Finance", MaVaiTro: "Employee", TrangThai: "HoatDong"},
            {Title: "EMP004", HoTen: "Phạm Thị Dung", Email: "dung.pham@company.com", 
             MaDonVi: "Marketing", MaVaiTro: "Director", TrangThai: "HoatDong"}
          ), 
          NguoiDung)
        );
        Set(varAllDepartments, If(IsEmpty(DonVi),
          Table(
            {MaDonVi: "IT", TenDonVi: "Phòng Công nghệ thông tin"},
            {MaDonVi: "HR", TenDonVi: "Phòng Nhân sự"},
            {MaDonVi: "Finance", TenDonVi: "Phòng Tài chính"},
            {MaDonVi: "Marketing", TenDonVi: "Phòng Marketing"}
          ),
          DonVi)
        ); 
        Set(varAllRoles, If(IsEmpty(VaiTro),
          Table(
            {MaVaiTro: "Employee", TenVaiTro: "Nhân viên"},
            {MaVaiTro: "Manager", TenVaiTro: "Quản lý"},
            {MaVaiTro: "Director", TenVaiTro: "Giám đốc"},
            {MaVaiTro: "HR", TenVaiTro: "Nhân sự"},
            {MaVaiTro: "Admin", TenVaiTro: "Quản trị viên"}
          ),
          VaiTro)
        );
        Set(varHolidaysList, If(IsEmpty(NgayLe),
          Table(
            {TenNgayLe: "Tết Nguyên đán", Ngay: "2024-01-01", Nam: 2024, Buoi: "CaNgay"},
            {TenNgayLe: "Giỗ tổ Hùng Vương", Ngay: "2024-04-18", Nam: 2024, Buoi: "CaNgay"},
            {TenNgayLe: "Ngày Quốc khánh", Ngay: "2024-09-02", Nam: 2024, Buoi: "CaNgay"},
            {TenNgayLe: "Ngày thành lập Đảng", Ngay: "2024-02-03", Nam: 2024, Buoi: "CaNgay"}
          ),
          NgayLe)
        );
        Set(varLeaveBalanceData, If(IsEmpty(SoNgayPhep),
          Table(
            {MaNguoiDung: "EMP001", Nam: 2024, TongNgayDuocPhep: 12, SoNgayDaNghi: 3, SoNgayConLai: 9},
            {MaNguoiDung: "EMP002", Nam: 2024, TongNgayDuocPhep: 15, SoNgayDaNghi: 5, SoNgayConLai: 10},
            {MaNguoiDung: "EMP003", Nam: 2024, TongNgayDuocPhep: 12, SoNgayDaNghi: 2, SoNgayConLai: 10}
          ),
          SoNgayPhep)
        );
        Set(varWorkflowData, If(IsEmpty(QuyTrinhDuyet),
          Table(
            {MaDonVi: "IT", Cap: "1", MaVaiTro: "Manager", NguoiDuyetMacDinh: "EMP002", DangHoatDong: true},
            {MaDonVi: "IT", Cap: "2", MaVaiTro: "Director", NguoiDuyetMacDinh: "EMP003", DangHoatDong: true},
            {MaDonVi: "HR", Cap: "1", MaVaiTro: "Manager", NguoiDuyetMacDinh: "EMP002", DangHoatDong: true}
          ),
          QuyTrinhDuyet)
        );
        Set(varShowImportModal, false);
        Set(varSelectedHoliday, Blank());
        Set(varIsHolidayFormOpen, false);
        Set(varHolidayFormDate, Today());
        Set(varHolidayFormName, "")
    Children:
      # Header Component
      - 'Management.Header':
          Control: CanvasComponent
          ComponentName: HeaderComponent
          Properties:
            X: =0
            Y: =0
            Width: =Parent.Width
            Height: =Parent.Height * 0.065
            UserName: =UserSession.HoTen
            UserRole: =UserSession.MaVaiTro
            ShowNotification: =true
            NotificationCount: =0
            OnLogout: |
              =Set(varIsUserAuthenticated, false);
              Set(UserSession, {
                Id: "", 
                Name: "", 
                Email: "", 
                Role: "", 
                Permission: 0,
                NguoiQuanLyId: "", 
                HoTen: "", 
                MaVaiTro: "", 
                ChucDanh: "", 
                MaDonVi: "", 
                TrangThai: ""
              });
              Navigate(LoginScreen)
            
      # Navigation Component
      - 'Management.Navigation':
          Control: CanvasComponent
          ComponentName: NavigationComponent
          Properties:
            X: =0
            Y: ='Management.Header'.Height
            Width: =If(varNavCollapsed, App.Width * 0.045, App.Width * 0.14)
            Height: =Parent.Height - 'Management.Header'.Height
            UserRole: =UserSession.MaVaiTro
            ActiveScreen: ="Management"
            IsCollapsed: =varNavCollapsed
            DashboardScreen: =DashboardScreen
            LeaveRequestScreen: =LeaveRequestScreen
            MyLeavesScreen: =MyLeavesScreen
            CalendarScreen: =CalendarScreen
            ManagementScreen: =ManagementScreen
            ProfileScreen: =ProfileScreen
            OnNavigate: |
              =Set(varActiveScreen, ScreenName);
              Switch(ScreenName,
                "Dashboard", Navigate(DashboardScreen),
                "LeaveRequest", Navigate(LeaveRequestScreen),
                "MyLeaves", Navigate(MyLeavesScreen),
                "Calendar", Navigate(CalendarScreen),
                "Management", Navigate(ManagementScreen),
                "Profile", Navigate(ProfileScreen),
                "Approval", Navigate(ApprovalScreen),
                "Reports", Navigate(ReportsScreen)
              )
            OnToggleCollapse: |
              =Set(varNavCollapsed, !varNavCollapsed)
            
      # Main Content Container
      - 'Management.Content.Container':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: ='Management.Navigation'.Width
            Y: ='Management.Header'.Height
            Width: =Parent.Width - 'Management.Navigation'.Width
            Height: =Parent.Height - 'Management.Header'.Height
          Children:
            - 'Management.Content.Padded':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.01
                  Y: =Parent.Height * 0.01
                  Width: =Parent.Width * 0.98
                  Height: =Parent.Height * 0.98
                Children:
                  # Page Header
                  - 'Management.PageHeader.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =0
                        Y: =0
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.1
                      Children:
                        - 'Management.PageHeader.Background':
                            Control: Rectangle
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Fill: =RGBA(255, 255, 255, 1)
                              BorderColor: =RGBA(226, 232, 240, 1)
                              BorderThickness: =1
                              
                        - 'Management.PageHeader.Icon':
                            Control: Classic/Icon
                            Properties:
                              X: =Parent.Width * 0.015
                              Y: =Parent.Height * 0.25
                              Width: =Parent.Height * 0.2
                              Height: =Parent.Height * 0.2
                              Icon: =Icon.Settings
                              Color: =RGBA(59, 130, 246, 1)
                              
                        - 'Management.PageHeader.Title':
                            Control: Label
                            Properties:
                              X: =Parent.Width * 0.015 + 'Management.PageHeader.Icon'.Width + Parent.Width * 0.01
                              Y: =Parent.Height * 0.2
                              Width: =Parent.Width * 0.6
                              Height: =Parent.Height * 0.35
                              Text: ="Quản lý hệ thống"
                              Color: =RGBA(17, 24, 39, 1)
                              Font: =Font.'Open Sans'
                              FontWeight: =FontWeight.Bold
                              Size: =14
                        
                        - 'Management.PageHeader.Stats':
                            Control: Label
                            Properties:
                              X: =Parent.Width * 0.015 + 'Management.PageHeader.Icon'.Width + Parent.Width * 0.01
                              Y: =Parent.Height * 0.6
                              Width: =Parent.Width * 0.6
                              Height: =Parent.Height * 0.25
                              Text: ="Quản lý người dùng, ngày phép, lịch nghỉ lễ và quy trình"
                              Color: =RGBA(75, 85, 99, 1)
                              Font: =Font.'Open Sans'
                              Size: =11

                  # Tab Navigation
                  - 'Management.Tabs.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =0
                        Y: ='Management.PageHeader.Container'.Y + 'Management.PageHeader.Container'.Height + Parent.Height * 0.015
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.08
                      Children:
                        - 'Management.Tabs.Background':
                            Control: Rectangle
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Fill: =RGBA(249, 250, 251, 1)
                              BorderColor: =RGBA(226, 232, 240, 1)
                              BorderThickness: =1
                              
                        - 'Management.Tabs.Users':
                            Control: CanvasComponent
                            ComponentName: ButtonComponent
                            Properties:
                              X: =Parent.Width * 0.02
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width * 0.15
                              Height: =Parent.Height * 0.7
                              Text: ="Người dùng"
                              Variant: =If(varSelectedManagementTab = "Users", "Primary", "Outline")
                              Size: ="Small"
                              OnClick: |
                                =Set(varSelectedManagementTab, "Users")
                                      
                        - 'Management.Tabs.LeaveBalance':
                            Control: CanvasComponent
                            ComponentName: ButtonComponent
                            Properties:
                              X: =Parent.Width * 0.18
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width * 0.15
                              Height: =Parent.Height * 0.7
                              Text: ="Số ngày phép"
                              Variant: =If(varSelectedManagementTab = "LeaveBalance", "Primary", "Outline")
                              Size: ="Small"
                              OnClick: |
                                =Set(varSelectedManagementTab, "LeaveBalance")
                                      
                        - 'Management.Tabs.Holidays':
                            Control: CanvasComponent
                            ComponentName: ButtonComponent
                            Properties:
                              X: =Parent.Width * 0.34
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width * 0.15
                              Height: =Parent.Height * 0.7
                              Text: ="Ngày nghỉ lễ"
                              Variant: =If(varSelectedManagementTab = "Holidays", "Primary", "Outline")
                              Size: ="Small"
                              OnClick: |
                                =Set(varSelectedManagementTab, "Holidays")
                                      
                        - 'Management.Tabs.Workflow':
                            Control: CanvasComponent
                            ComponentName: ButtonComponent
                            Properties:
                              X: =Parent.Width * 0.5
                              Y: =(Parent.Height - Self.Height) / 2
                              Width: =Parent.Width * 0.15
                              Height: =Parent.Height * 0.7
                              Text: ="Quy trình"
                              Variant: =If(varSelectedManagementTab = "Workflow", "Primary", "Outline")
                              Size: ="Small"
                              OnClick: |
                                =Set(varSelectedManagementTab, "Workflow")

                  # Tab Content Container
                  - 'Management.TabContent.Container':
                      Control: GroupContainer
                      Variant: ManualLayout
                      Properties:
                        X: =0
                        Y: ='Management.Tabs.Container'.Y + 'Management.Tabs.Container'.Height + Parent.Height * 0.015
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.75
                      Children:
                        # ===== TAB NGƯỜI DÙNG =====
                        - 'Management.Users.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Visible: =varSelectedManagementTab = "Users"
                            Children:
                              # Users Header với nút Add
                              - 'Management.Users.Header':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.12
                                  Children:
                                    - 'Management.Users.Header.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(255, 255, 255, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    - 'Management.Users.Header.Title':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.45
                                          Height: =Parent.Height * 0.5
                                          Text: =Concatenate("Danh sách người dùng", " ", "(", 
                                            CountRows(NguoiDung), 
                                            " ", "người", ")")
                                          Color: =RGBA(17, 24, 39, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Semibold
                                          Size: =16

                                    - 'Management.Users.AddButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.55
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.2
                                          Height: =Parent.Height * 0.6
                                          Text: ="Thêm người dùng"
                                          Variant: ="Primary"
                                          Size: ="Medium"
                                          OnClick: |
                                            =Set(varIsEditingUser, false);
                                            Set(varSelectedUser, Blank());
                                            Set(varUserFormName, "");
                                            Set(varUserFormEmail, "");
                                            Set(varUserFormRole, "");
                                            Set(varUserFormDepartment, "");
                                            Set(varUserFormStatus, "HoatDong");
                                            Set(varIsUserFormOpen, true)

                                    - 'Management.Users.RefreshButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.77
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.2
                                          Height: =Parent.Height * 0.6
                                          Text: ="Làm mới"
                                          Variant: ="Outline"
                                          Size: ="Medium"
                                          OnClick: |
                                            =Refresh(NguoiDung);
                                            Refresh(DonVi);
                                            Refresh(VaiTro);
                                            Notify("Đã làm mới dữ liệu", NotificationType.Success)

                        # ===== TAB SỐ NGÀY PHÉP =====
                        - 'Management.LeaveBalance.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Visible: =varSelectedManagementTab = "LeaveBalance"
                            Children:
                              # LeaveBalance Header
                              - 'Management.LeaveBalance.Header':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.12
                                  Children:
                                    - 'Management.LeaveBalance.Header.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(255, 255, 255, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    - 'Management.LeaveBalance.Header.Title':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.6
                                          Height: =Parent.Height * 0.5
                                          Text: ="Quản lý số ngày nghỉ phép"
                                          Color: =RGBA(17, 24, 39, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Bold
                                          Size: =12

                                    - 'Management.LeaveBalance.ImportButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.75
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.22
                                          Height: =Parent.Height * 0.6
                                          Text: ="Import Excel"
                                          Variant: ="Primary"
                                          Size: ="Medium"
                                          OnClick: |
                                            =Set(varShowImportModal, true)

                        # ===== TAB NGÀY NGHỈ LỄ =====
                        - 'Management.Holidays.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Visible: =varSelectedManagementTab = "Holidays"
                            Children:
                              # Holidays Header
                              - 'Management.Holidays.Header':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.12
                                  Children:
                                    - 'Management.Holidays.Header.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(255, 255, 255, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    - 'Management.Holidays.Header.Title':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.6
                                          Height: =Parent.Height * 0.5
                                          Text: =Concatenate("Danh sách ngày nghỉ lễ", " ", "(", CountRows(varHolidaysList), " ", "ngày", ")")
                                          Color: =RGBA(17, 24, 39, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Bold
                                          Size: =12

                                    - 'Management.Holidays.AddButton':
                                        Control: CanvasComponent
                                        ComponentName: ButtonComponent
                                        Properties:
                                          X: =Parent.Width * 0.75
                                          Y: =(Parent.Height - Self.Height) / 2
                                          Width: =Parent.Width * 0.22
                                          Height: =Parent.Height * 0.6
                                          Text: ="Thêm ngày lễ"
                                          Variant: ="Primary"
                                          Size: ="Medium"
                                          OnClick: |
                                            =Set(varSelectedHoliday, Blank());
                                            Set(varHolidayFormName, "");
                                            Set(varHolidayFormDate, Today());
                                            Set(varIsHolidayFormOpen, true)

                        # ===== TAB QUY TRÌNH =====
                        - 'Management.Workflow.Container':
                            Control: GroupContainer
                            Variant: ManualLayout
                            Properties:
                              X: =0
                              Y: =0
                              Width: =Parent.Width
                              Height: =Parent.Height
                              Visible: =varSelectedManagementTab = "Workflow"
                            Children:
                              # Workflow Header
                              - 'Management.Workflow.Header':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: =0
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.15
                                  Children:
                                    - 'Management.Workflow.Header.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(255, 255, 255, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    - 'Management.Workflow.Header.Title':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =Parent.Height * 0.1
                                          Width: =Parent.Width * 0.96
                                          Height: =Parent.Height * 0.3
                                          Text: ="Quy trình phê duyệt 3 cấp"
                                          Color: =RGBA(17, 24, 39, 1)
                                          Font: =Font.'Open Sans'
                                          FontWeight: =FontWeight.Bold
                                          Size: =14

                                    - 'Management.Workflow.Header.Description':
                                        Control: Label
                                        Properties:
                                          X: =Parent.Width * 0.02
                                          Y: =Parent.Height * 0.5
                                          Width: =Parent.Width * 0.96
                                          Height: =Parent.Height * 0.4
                                          Text: ="Thiết lập người phê duyệt cho từng cấp theo đơn vị. Chỉ có thể thay đổi khi không có đơn nào đang chờ phê duyệt."
                                          Color: =RGBA(75, 85, 99, 1)
                                          Font: =Font.'Open Sans'
                                          Size: =11

                              # Workflow Process Diagram
                              - 'Management.Workflow.Process':
                                  Control: GroupContainer
                                  Variant: ManualLayout
                                  Properties:
                                    X: =0
                                    Y: ='Management.Workflow.Header'.Y + 'Management.Workflow.Header'.Height + Parent.Height * 0.02
                                    Width: =Parent.Width
                                    Height: =Parent.Height * 0.4
                                  Children:
                                    - 'Management.Workflow.Process.Background':
                                        Control: Rectangle
                                        Properties:
                                          X: =0
                                          Y: =0
                                          Width: =Parent.Width
                                          Height: =Parent.Height
                                          Fill: =RGBA(249, 250, 251, 1)
                                          BorderColor: =RGBA(226, 232, 240, 1)
                                          BorderThickness: =1

                                    # Step 1
                                    - 'Management.Workflow.Step1':
                                        Control: GroupContainer
                                        Variant: ManualLayout
                                        Properties:
                                          X: =Parent.Width * 0.05
                                          Y: =Parent.Height * 0.2
                                          Width: =Parent.Width * 0.25
                                          Height: =Parent.Height * 0.6
                                        Children:
                                          - 'Management.Workflow.Step1.Background':
                                              Control: Rectangle
                                              Properties:
                                                X: =0
                                                Y: =0
                                                Width: =Parent.Width
                                                Height: =Parent.Height
                                                Fill: =RGBA(59, 130, 246, 0.1)
                                                BorderColor: =RGBA(59, 130, 246, 1)
                                                BorderThickness: =2

                                          - 'Management.Workflow.Step1.Title':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.1
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.3
                                                Text: ="CẤP 1"
                                                Color: =RGBA(59, 130, 246, 1)
                                                Font: =Font.'Open Sans'
                                                FontWeight: =FontWeight.Bold
                                                Size: =12
                                                Align: =Align.Center

                                          - 'Management.Workflow.Step1.Role':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.45
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.45
                                                Text: ="Trưởng nhóm/Trưởng phòng"
                                                Color: =RGBA(17, 24, 39, 1)
                                                Font: =Font.'Open Sans'
                                                Size: =10
                                                Align: =Align.Center
                                                Wrap: =true

                                    # Arrow 1
                                    - 'Management.Workflow.Arrow1':
                                        Control: Classic/Icon
                                        Properties:
                                          X: =Parent.Width * 0.32
                                          Y: =Parent.Height * 0.45
                                          Width: =Parent.Width * 0.04
                                          Height: =Parent.Height * 0.1
                                          Icon: =Icon.ChevronRight
                                          Color: =RGBA(75, 85, 99, 1)

                                    # Step 2
                                    - 'Management.Workflow.Step2':
                                        Control: GroupContainer
                                        Variant: ManualLayout
                                        Properties:
                                          X: =Parent.Width * 0.38
                                          Y: =Parent.Height * 0.2
                                          Width: =Parent.Width * 0.25
                                          Height: =Parent.Height * 0.6
                                        Children:
                                          - 'Management.Workflow.Step2.Background':
                                              Control: Rectangle
                                              Properties:
                                                X: =0
                                                Y: =0
                                                Width: =Parent.Width
                                                Height: =Parent.Height
                                                Fill: =RGBA(251, 191, 36, 0.1)
                                                BorderColor: =RGBA(251, 191, 36, 1)
                                                BorderThickness: =2

                                          - 'Management.Workflow.Step2.Title':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.1
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.3
                                                Text: ="CẤP 2"
                                                Color: =RGBA(251, 191, 36, 1)
                                                Font: =Font.'Open Sans'
                                                FontWeight: =FontWeight.Bold
                                                Size: =12
                                                Align: =Align.Center

                                          - 'Management.Workflow.Step2.Role':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.45
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.45
                                                Text: ="Giám đốc khối"
                                                Color: =RGBA(17, 24, 39, 1)
                                                Font: =Font.'Open Sans'
                                                Size: =10
                                                Align: =Align.Center

                                    # Arrow 2
                                    - 'Management.Workflow.Arrow2':
                                        Control: Classic/Icon
                                        Properties:
                                          X: =Parent.Width * 0.65
                                          Y: =Parent.Height * 0.45
                                          Width: =Parent.Width * 0.04
                                          Height: =Parent.Height * 0.1
                                          Icon: =Icon.ChevronRight
                                          Color: =RGBA(75, 85, 99, 1)

                                    # Step 3
                                    - 'Management.Workflow.Step3':
                                        Control: GroupContainer
                                        Variant: ManualLayout
                                        Properties:
                                          X: =Parent.Width * 0.71
                                          Y: =Parent.Height * 0.2
                                          Width: =Parent.Width * 0.25
                                          Height: =Parent.Height * 0.6
                                        Children:
                                          - 'Management.Workflow.Step3.Background':
                                              Control: Rectangle
                                              Properties:
                                                X: =0
                                                Y: =0
                                                Width: =Parent.Width
                                                Height: =Parent.Height
                                                Fill: =RGBA(239, 68, 68, 0.1)
                                                BorderColor: =RGBA(239, 68, 68, 1)
                                                BorderThickness: =2

                                          - 'Management.Workflow.Step3.Title':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.1
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.3
                                                Text: ="CẤP 3"
                                                Color: =RGBA(239, 68, 68, 1)
                                                Font: =Font.'Open Sans'
                                                FontWeight: =FontWeight.Bold
                                                Size: =12
                                                Align: =Align.Center

                                          - 'Management.Workflow.Step3.Role':
                                              Control: Label
                                              Properties:
                                                X: =0
                                                Y: =Parent.Height * 0.45
                                                Width: =Parent.Width
                                                Height: =Parent.Height * 0.45
                                                Text: ="Giám đốc điều hành"
                                                Color: =RGBA(17, 24, 39, 1)
                                                Font: =Font.'Open Sans'
                                                Size: =10
                                                Align: =Align.Center

                              # Workflow DataTable đã được di chuyển ra làm direct children của Screen
                              # Xóa bỏ phần này để tránh duplicate

      # ===== MODAL FORMS =====
      
      # User Form Modal
      - 'Management.UserForm.Modal':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: =(Parent.Width - Self.Width) / 2
            Y: =(Parent.Height - Self.Height) / 2
            Width: =Parent.Width * 0.5
            Height: =Parent.Height * 0.7
            Fill: =RGBA(255, 255, 255, 1)
            BorderColor: =RGBA(226, 232, 240, 1)
            BorderThickness: =2
            Visible: =varIsUserFormOpen
          Children:
            # Form Header
            - 'Management.UserForm.Header':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =0
                  Y: =0
                  Width: =Parent.Width
                  Height: =Parent.Height * 0.15
                  Fill: =RGBA(59, 130, 246, 1)
                Children:
                  - 'Management.UserForm.Title':
                      Control: Label
                      Properties:
                        X: =Parent.Width * 0.05
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.7
                        Height: =Parent.Height * 0.6
                        Text: =If(varIsEditingUser, "Chỉnh sửa người dùng", "Thêm người dùng mới")
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =14

                  - 'Management.UserForm.CloseButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.85
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.12
                        Height: =Parent.Height * 0.6
                        Text: ="Đóng"
                        Variant: ="Outline"
                        Size: ="Small"
                        OnClick: |
                          =Set(varIsUserFormOpen, false)

            # Form Content
            - 'Management.UserForm.Content':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: ='Management.UserForm.Header'.Height + Parent.Height * 0.03
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.65
                Children:
                  # Name Field
                  - 'Management.UserForm.Name.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =0
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Họ và tên:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =12

                  - 'Management.UserForm.Name.Input':
                      Control: Classic/TextInput
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =0
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Default: =varUserFormName
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =12
                        OnChange: |
                          =Set(varUserFormName, Self.Text)

                  # Email Field
                  - 'Management.UserForm.Email.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.15
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Email:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =12

                  - 'Management.UserForm.Email.Input':
                      Control: Classic/TextInput
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.15
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Default: =varUserFormEmail
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =12
                        OnChange: |
                          =Set(varUserFormEmail, Self.Text)

                  # Department Field
                  - 'Management.UserForm.Department.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.3
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Đơn vị:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =12

                  - 'Management.UserForm.Department.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.3
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Items: =DonVi
                        Default: =If(IsBlank(varUserFormDepartment), 
                          First(DonVi),
                          LookUp(DonVi, MaDonVi = varUserFormDepartment))
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        OnChange: |
                          =Set(varUserFormDepartment, Self.Selected.MaDonVi)

                  # Role Field
                  - 'Management.UserForm.Role.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.45
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Vai trò:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =12

                  - 'Management.UserForm.Role.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.45
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Items: =VaiTro
                        Default: =If(IsBlank(varUserFormRole),
                          First(VaiTro),
                          LookUp(VaiTro, MaVaiTro = varUserFormRole))
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        OnChange: |
                          =Set(varUserFormRole, Self.Selected.MaVaiTro)

                  # Status Field
                  - 'Management.UserForm.Status.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.6
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.1
                        Text: ="Trạng thái:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =12

                  - 'Management.UserForm.Status.Dropdown':
                      Control: Classic/DropDown
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.6
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.08
                        Items: =["HoatDong", "KhongHoatDong"]
                        Default: =varUserFormStatus
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        OnChange: |
                          =Set(varUserFormStatus, Self.Selected.Value)

            # Form Actions
            - 'Management.UserForm.Actions':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: =Parent.Height * 0.85
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.12
                Children:
                  - 'Management.UserForm.SaveButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =0
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: =If(varIsEditingUser, "Cập nhật", "Thêm mới")
                        Variant: ="Primary"
                        Size: ="Medium"
                        OnClick: |
                          =If(varIsEditingUser,
                            Patch(NguoiDung, varSelectedUser, {
                              HoTen: varUserFormName,
                              Email: varUserFormEmail,
                              MaDonVi: LookUp(DonVi, MaDonVi = varUserFormDepartment),
                              MaVaiTro: LookUp(VaiTro, MaVaiTro = varUserFormRole),
                              TrangThai: LookUp(Choices(NguoiDung.TrangThai), Value = varUserFormStatus)
                            }),
                            Patch(NguoiDung, Defaults(NguoiDung), {
                              Title: varUserFormName,
                              HoTen: varUserFormName,
                              Email: varUserFormEmail,
                              MaDonVi: LookUp(DonVi, MaDonVi = varUserFormDepartment),
                              MaVaiTro: LookUp(VaiTro, MaVaiTro = varUserFormRole),
                              TrangThai: LookUp(Choices(NguoiDung.TrangThai), Value = varUserFormStatus)
                            })
                          );
                          Set(varAllUsers, If(IsEmpty(NguoiDung), varAllUsers, NguoiDung));
                          Set(varIsUserFormOpen, false);
                          Notify(If(varIsEditingUser, "Cập nhật thành công", "Thêm mới thành công"), NotificationType.Success)

                  - 'Management.UserForm.CancelButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.55
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: ="Hủy"
                        Variant: ="Outline"
                        Size: ="Medium"
                        OnClick: |
                          =Set(varIsUserFormOpen, false)

      # Holiday Form Modal
      - 'Management.HolidayForm.Modal':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: =(Parent.Width - Self.Width) / 2
            Y: =(Parent.Height - Self.Height) / 2
            Width: =Parent.Width * 0.4
            Height: =Parent.Height * 0.5
            Fill: =RGBA(255, 255, 255, 1)
            BorderColor: =RGBA(226, 232, 240, 1)
            BorderThickness: =2
            Visible: =varIsHolidayFormOpen
          Children:
            # Form Header
            - 'Management.HolidayForm.Header':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =0
                  Y: =0
                  Width: =Parent.Width
                  Height: =Parent.Height * 0.2
                  Fill: =RGBA(251, 191, 36, 1)
                Children:
                  - 'Management.HolidayForm.Title':
                      Control: Label
                      Properties:
                        X: =Parent.Width * 0.05
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.7
                        Height: =Parent.Height * 0.6
                        Text: =If(Not(IsBlank(varSelectedHoliday)), "Chỉnh sửa ngày lễ", "Thêm ngày lễ mới")
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =14

                  - 'Management.HolidayForm.CloseButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.85
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.12
                        Height: =Parent.Height * 0.6
                        Text: ="Đóng"
                        Variant: ="Outline"
                        Size: ="Small"
                        OnClick: |
                          =Set(varIsHolidayFormOpen, false)

            # Form Content
            - 'Management.HolidayForm.Content':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: ='Management.HolidayForm.Header'.Height + Parent.Height * 0.05
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.6
                Children:
                  # Name Field
                  - 'Management.HolidayForm.Name.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =0
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.15
                        Text: ="Tên ngày lễ:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =12

                  - 'Management.HolidayForm.Name.Input':
                      Control: Classic/TextInput
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =0
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.12
                        Default: =varHolidayFormName
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =12
                        OnChange: |
                          =Set(varHolidayFormName, Self.Text)

                  # Date Field
                  - 'Management.HolidayForm.Date.Label':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.25
                        Width: =Parent.Width * 0.3
                        Height: =Parent.Height * 0.15
                        Text: ="Ngày:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =12

                  - 'Management.HolidayForm.Date.Input':
                      Control: Classic/DatePicker
                      Properties:
                        X: =Parent.Width * 0.35
                        Y: =Parent.Height * 0.25
                        Width: =Parent.Width * 0.6
                        Height: =Parent.Height * 0.12
                        DefaultDate: =varHolidayFormDate
                        BorderColor: =RGBA(226, 232, 240, 1)
                        BorderThickness: =1
                        Font: =Font.'Open Sans'
                        Size: =12
                        OnChange: |
                          =Set(varHolidayFormDate, Self.SelectedDate)

            # Form Actions
            - 'Management.HolidayForm.Actions':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: =Parent.Height * 0.85
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.12
                Children:
                  - 'Management.HolidayForm.SaveButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =0
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: =If(Not(IsBlank(varSelectedHoliday)), "Cập nhật", "Thêm mới")
                        Variant: ="Primary"
                        Size: ="Medium"
                        OnClick: |
                          =If(Not(IsBlank(varSelectedHoliday)),
                            Patch(NgayLe, varSelectedHoliday, {
                              TenNgayLe: varHolidayFormName,
                              Ngay: Text(varHolidayFormDate, "yyyy-mm-dd"),
                              Nam: Year(varHolidayFormDate)
                            }),
                            Patch(NgayLe, Defaults(NgayLe), {
                              TenNgayLe: varHolidayFormName,
                              Ngay: Text(varHolidayFormDate, "yyyy-mm-dd"),
                              Nam: Year(varHolidayFormDate),
                              Buoi: LookUp(Choices(NgayLe.Buoi), Value = "CaNgay")
                            })
                          );
                          Set(varHolidaysList, If(IsEmpty(NgayLe), varHolidaysList, NgayLe));
                          Set(varIsHolidayFormOpen, false);
                          Notify(If(Not(IsBlank(varSelectedHoliday)), "Cập nhật thành công", "Thêm mới thành công"), NotificationType.Success)

                  - 'Management.HolidayForm.CancelButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.55
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: ="Hủy"
                        Variant: ="Outline"
                        Size: ="Medium"
                        OnClick: |
                          =Set(varIsHolidayFormOpen, false)

      # Import Modal
      - 'Management.Import.Modal':
          Control: GroupContainer
          Variant: ManualLayout
          Properties:
            X: =(Parent.Width - Self.Width) / 2
            Y: =(Parent.Height - Self.Height) / 2
            Width: =Parent.Width * 0.6
            Height: =Parent.Height * 0.6
            Fill: =RGBA(255, 255, 255, 1)
            BorderColor: =RGBA(226, 232, 240, 1)
            BorderThickness: =2
            Visible: =varShowImportModal
          Children:
            # Import Header
            - 'Management.Import.Header':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =0
                  Y: =0
                  Width: =Parent.Width
                  Height: =Parent.Height * 0.15
                  Fill: =RGBA(34, 197, 94, 1)
                Children:
                  - 'Management.Import.Title':
                      Control: Label
                      Properties:
                        X: =Parent.Width * 0.05
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.7
                        Height: =Parent.Height * 0.6
                        Text: ="Import số ngày nghỉ phép từ Excel"
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =14

                  - 'Management.Import.CloseButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.85
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.12
                        Height: =Parent.Height * 0.6
                        Text: ="Đóng"
                        Variant: ="Outline"
                        Size: ="Small"
                        OnClick: |
                          =Set(varShowImportModal, false)

            # Import Instructions
            - 'Management.Import.Instructions':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: ='Management.Import.Header'.Height + Parent.Height * 0.03
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.6
                Children:
                  - 'Management.Import.Instructions.Title':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =0
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.15
                        Text: ="Hướng dẫn import file Excel:"
                        Color: =RGBA(17, 24, 39, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Bold
                        Size: =12

                  - 'Management.Import.Instructions.Content':
                      Control: Label
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.2
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.6
                        Text: |
                          =Concatenate(
                          "File Excel cần có các cột sau:", Char(10),
                          "• Mã Nhân viên", Char(10),
                          "• Họ và tên", Char(10),
                          "• Email", Char(10),
                          "• Tổng ngày phép", Char(10),
                          "• Năm", Char(10), Char(10),
                          "Lưu ý:File phải ở định dạng .xlsx hoặc .csv"
                          )
                        Color: =RGBA(75, 85, 99, 1)
                        Font: =Font.'Open Sans'
                        Size: =11
                        Wrap: =true

                  - 'Management.Import.FileUpload':
                      Control: AddMedia
                      Properties:
                        X: =0
                        Y: =Parent.Height * 0.85
                        Width: =Parent.Width
                        Height: =Parent.Height * 0.12
                        Text: ="Chọn file Excel"
                        BorderColor: =RGBA(59, 130, 246, 1)
                        BorderThickness: =2
                        Color: =RGBA(59, 130, 246, 1)
                        Fill: =RGBA(239, 246, 255, 1)
                        Font: =Font.'Open Sans'
                        FontWeight: =FontWeight.Semibold
                        Size: =12

            # Import Actions
            - 'Management.Import.Actions':
                Control: GroupContainer
                Variant: ManualLayout
                Properties:
                  X: =Parent.Width * 0.05
                  Y: =Parent.Height * 0.85
                  Width: =Parent.Width * 0.9
                  Height: =Parent.Height * 0.12
                Children:
                  - 'Management.Import.ProcessButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =0
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: ="Xử lý import"
                        Variant: ="Primary"
                        Size: ="Medium"
                        OnClick: |
                          =Notify("Chức năng import sẽ được triển khai trong phiên bản tiếp theo", NotificationType.Information);
                          Set(varShowImportModal, false)

                  - 'Management.Import.CancelButton':
                      Control: CanvasComponent
                      ComponentName: ButtonComponent
                      Properties:
                        X: =Parent.Width * 0.55
                        Y: =(Parent.Height - Self.Height) / 2
                        Width: =Parent.Width * 0.45
                        Height: =Parent.Height * 0.8
                        Text: ="Hủy"
                        Variant: ="Outline"
                        Size: ="Medium"
                        OnClick: |
                          =Set(varShowImportModal, false)

      # Users DataTable
      - 'Management.Users.DataTable':
          Control: DataTable
          Variant: DataTable
          Properties:
            X: ='Management.Navigation'.Width + 'Management.Content.Padded'.X
            Y: ='Management.Content.Container'.Y + 'Management.Content.Padded'.Y + 'Management.TabContent.Container'.Y + 'Management.Users.Header'.Height
            Width: ='Management.Content.Padded'.Width
            Height: ='Management.Users.Container'.Height + ('Management.Content.Padded'.Height - Self.Y - 'Management.Users.Container'.Height)
            Items: =NguoiDung
            BorderColor: =RGBA(203, 213, 225, 1)
            BorderThickness: =2
            Font: =Font.'Open Sans'
            Size: =12
            Color: =RGBA(15, 23, 42, 1)
            HeadingColor: =RGBA(255, 255, 255, 1)
            HeadingFill: =RGBA(30, 58, 138, 1)
            HeadingFont: =Font.'Open Sans'
            HeadingFontWeight: =FontWeight.Bold
            HeadingSize: =13
            Fill: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(241, 245, 249, 1)
            NoDataText: ="Không có dữ liệu người dùng"
            Visible: =varSelectedManagementTab = "Users"
          Children:
            - UserName_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Họ tên"
                  FieldName: ="HoTen"
                  Order: =1
                  Text: =ThisItem.HoTen
                  Width: =200
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true);
                    Set(varSelectedUser, Parent.Selected);
                    Set(varIsEditingUser, true);
                    Set(varUserFormName, Parent.Selected.HoTen);
                    Set(varUserFormEmail, Parent.Selected.Email);
                    Set(varUserFormDepartment, If(Not(IsBlank(Parent.Selected.'MaDonVi: TenDonVi'.Value)), Parent.Selected.'MaDonVi: TenDonVi'.Value, ""));
                    Set(varUserFormRole, If(Not(IsBlank(Parent.Selected.'MaVaiTro: TenVaiTro'.Value)), Parent.Selected.'MaVaiTro: TenVaiTro'.Value, ""));
                    Set(varUserFormStatus, If(Not(IsBlank(Parent.Selected.TrangThai.Value)), Parent.Selected.TrangThai.Value, "HoatDong"));
                    Set(varIsUserFormOpen, true)

            - UserEmail_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Email"
                  FieldName: ="Email"
                  Order: =2
                  Text: =ThisItem.Email
                  Width: =250
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - 'MaDonVi: TenDonVi_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: |-
                    ="MaDonVi: TenDonVi"
                  FieldName: ="MaDonVi_x003a__x0020_TenDonVi"
                  Order: =3
                  Text: |-
                    =ThisItem.'MaDonVi: TenDonVi'.Value
                  Width: =180
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - UserPosition_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Chức danh"
                  FieldName: ="ChucDanh"
                  Order: =4
                  Text: =If(Not(IsBlank(ThisItem.ChucDanh.Value)), 
                    Switch(ThisItem.ChucDanh.Value,
                      "Nhân viên", "Nhân viên",
                      "Giám đốc khối", "Giám đốc khối", 
                      "Giám đốc điều hành", "Giám đốc điều hành",
                      "Chuyên viên", "Chuyên viên",
                      "Trưởng phòng", "Trưởng phòng",
                      ThisItem.ChucDanh.Value),
                    "Chưa cập nhật")
                  Width: =150
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - 'MaVaiTro: TenVaiTro_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: |-
                    ="MaVaiTro: TenVaiTro"
                  FieldName: ="MaVaiTro_x003a__x0020_TenVaiTro"
                  Order: =5
                  Text: |-
                    =ThisItem.'MaVaiTro: TenVaiTro'.Value
                  Width: =130
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - UserStatus_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Trạng thái"
                  FieldName: ="TrangThai"
                  Order: =6
                  Text: =If(Not(IsBlank(ThisItem.TrangThai.Value)),
                    Switch(ThisItem.TrangThai.Value,
                      "HoatDong", "Hoạt động",
                      "KhongHoatDong", "Không hoạt động",
                      ThisItem.TrangThai.Value),
                    "Chưa cập nhật")
                  Width: =120
                  OnSelect: |
                    =Set(varSelectedUserRecord, Parent.Selected);
                    Set(varRecordSelected, true)

      # LeaveBalance DataTable
      - 'Management.LeaveBalance.DataTable':
          Control: DataTable
          Variant: DataTable
          Properties:
            X: ='Management.Navigation'.Width + 'Management.Content.Padded'.X
            Y: ='Management.Content.Container'.Y + 'Management.Content.Padded'.Y + 'Management.TabContent.Container'.Y + 'Management.LeaveBalance.Header'.Height
            Width: ='Management.Content.Padded'.Width
            Height: ='Management.LeaveBalance.Container'.Height + ('Management.Content.Padded'.Height - Self.Y - 'Management.LeaveBalance.Container'.Height)
            Items: =SoNgayPhep
            BorderColor: =RGBA(203, 213, 225, 1)
            BorderThickness: =2
            Font: =Font.'Open Sans'
            Size: =12
            Color: =RGBA(15, 23, 42, 1)
            Fill: =RGBA(255, 255, 255, 1)
            HeadingColor: =RGBA(255, 255, 255, 1)
            HeadingFill: =RGBA(5, 150, 105, 1)
            HeadingFont: =Font.'Open Sans'
            HeadingFontWeight: =FontWeight.Bold
            HoverFill: =RGBA(240, 253, 244, 1)
            NoDataText: ="Không có dữ liệu số ngày phép"
            Visible: =varSelectedManagementTab = "LeaveBalance"
          Children:
            # Essential columns only
            - 'MaNguoiDung: HoTen_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Nhân viên"
                  FieldName: ="MaNguoiDung_x003a__x0020_HoTen"
                  Order: =1
                  Text: |
                    =ThisItem.'MaNguoiDung: HoTen'.Value
                  Width: =200

            - Nam_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Năm"
                  FieldName: ="Nam"
                  Order: =2
                  Text: =ThisItem.Nam
                  Width: =80

            - TongNgayDuocPhep_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Tổng ngày phép"
                  FieldName: ="TongNgayDuocPhep"
                  Order: =3
                  Text: =ThisItem.TongNgayDuocPhep
                  Width: =120

            - SoNgayDaNghi_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Đã nghỉ"
                  FieldName: ="SoNgayDaNghi"
                  Order: =4
                  Text: =ThisItem.SoNgayDaNghi
                  Width: =100

            - SoNgayConLai_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Còn lại"
                  FieldName: ="SoNgayConLai"
                  Order: =5
                  Text: =ThisItem.SoNgayConLai
                  Width: =100

            - SoNgayKhongLuong_Column:
                Control: DataTableColumn
                Variant: Number
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Không lương"
                  FieldName: ="SoNgayKhongLuong"
                  Order: =6
                  Text: =ThisItem.SoNgayKhongLuong
                  Width: =110

      # Holidays DataTable
      - 'Management.Holidays.DataTable':
          Control: DataTable
          Variant: DataTable
          Properties:
            X: ='Management.Navigation'.Width + 'Management.Content.Padded'.X
            Y: ='Management.Content.Container'.Y + 'Management.Content.Padded'.Y + 'Management.TabContent.Container'.Y + 'Management.Holidays.Header'.Height
            Width: ='Management.Content.Padded'.Width
            Height: ='Management.Holidays.Container'.Height + ('Management.Content.Padded'.Height - Self.Y - 'Management.Holidays.Container'.Height)
            Items: =varHolidaysList
            BorderColor: =RGBA(203, 213, 225, 1)
            BorderThickness: =2
            Font: =Font.'Open Sans'
            Size: =12
            Color: =RGBA(15, 23, 42, 1)
            HeadingColor: =RGBA(255, 255, 255, 1)
            HeadingFill: =RGBA(217, 119, 6, 1)
            HeadingFont: =Font.'Open Sans'
            HeadingFontWeight: =FontWeight.Bold
            HeadingSize: =13
            Fill: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(255, 251, 235, 1)
            NoDataText: ="Không có dữ liệu ngày nghỉ lễ"
            Visible: =varSelectedManagementTab = "Holidays"
          Children:
            - HolidayName_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Tên ngày lễ"
                  FieldName: ="TenNgayLe"
                  Order: =1
                  Text: =ThisItem.TenNgayLe
                  Width: =280
                  OnSelect: |
                    =Set(varSelectedHolidayRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - HolidayDate_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Ngày"
                  FieldName: ="Ngay"
                  Order: =2
                  Text: =Text(DateValue(ThisItem.Ngay), "dd/mm/yyyy")
                  Width: =120
                  OnSelect: |
                    =Set(varSelectedHolidayRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - HolidayYear_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Năm"
                  FieldName: ="Nam"
                  Order: =3
                  Text: =Text(ThisItem.Nam)
                  Width: =100
                  OnSelect: |
                    =Set(varSelectedHolidayRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - HolidaySession_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Buổi"
                  FieldName: ="Buoi"
                  Order: =4
                  Text: =If(IsEmpty(NgayLe),
                    Switch(ThisItem.Buoi, "CaNgay", "Cả ngày", "Sang", "Sáng", "Chieu", "Chiều", 
                      If(IsBlank(ThisItem.Buoi), "Cả ngày", Text(ThisItem.Buoi))),
                    Switch(ThisItem.Buoi.Value, "CaNgay", "Cả ngày", "Sang", "Sáng", "Chieu", "Chiều", 
                      If(IsBlank(ThisItem.Buoi.Value), "Cả ngày", Text(ThisItem.Buoi.Value))))
                  Width: =120
                  OnSelect: |
                    =Set(varSelectedHolidayRecord, Parent.Selected);
                    Set(varRecordSelected, true)

            - HolidayActions_Column:
                Control: DataTableColumn
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Thao tác"
                  FieldName: ="Actions"
                  Order: =5
                  Text: ="Xem | Sửa"
                  Width: =100
                  OnSelect: |
                    =Set(varSelectedHolidayRecord, Parent.Selected);
                    Set(varRecordSelected, true);
                    Set(varSelectedHoliday, Parent.Selected);
                    Set(varHolidayFormName, Parent.Selected.TenNgayLe);
                    Set(varHolidayFormDate, DateValue(Parent.Selected.Ngay));
                    Set(varIsHolidayFormOpen, true)

      # Workflow DataTable
      - 'Management.Workflow.DataTable':
          Control: DataTable
          Variant: DataTable
          Properties:
            X: ='Management.Navigation'.Width + 'Management.Content.Padded'.X
            Y: ='Management.Content.Container'.Y + 'Management.Content.Padded'.Y + 'Management.TabContent.Container'.Y + 'Management.Workflow.Process'.Y + 'Management.Workflow.Process'.Height
            Width: ='Management.Content.Padded'.Width
            Height: ='Management.Workflow.Container'.Height + ('Management.Content.Padded'.Height - Self.Y - 'Management.Workflow.Container'.Height)
            Items: =QuyTrinhDuyet
            BorderColor: =RGBA(203, 213, 225, 1)
            BorderThickness: =2
            Font: =Font.'Open Sans'
            Size: =12
            Color: =RGBA(15, 23, 42, 1)
            Fill: =RGBA(255, 255, 255, 1)
            HeadingColor: =RGBA(255, 255, 255, 1)
            HeadingFill: =RGBA(126, 34, 206, 1)
            HeadingFont: =Font.'Open Sans'
            HeadingFontWeight: =FontWeight.Bold
            HoverFill: =RGBA(250, 245, 255, 1)
            NoDataText: ="Không có dữ liệu quy trình duyệt"
            Visible: =varSelectedManagementTab = "Workflow"
          Children:
            # Essential workflow columns only
            - 'MaDonVi: TenDonVi_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Đơn vị"
                  FieldName: ="MaDonVi_x003a__x0020_TenDonVi"
                  Order: =1
                  Text: |
                    =ThisItem.'MaDonVi: TenDonVi'.Value
                  Width: =180

            - Cap_Column:
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Cấp duyệt"
                  FieldName: ="Cap"
                  Order: =2
                  Text: |
                    =Switch(ThisItem.Cap.Value,
                      "1", "Cấp 1",
                      "2", "Cấp 2", 
                      "3", "Cấp 3",
                      "Không xác định")
                  Width: =100

            - 'MaVaiTro: TenVaiTro_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Vai trò"
                  FieldName: ="MaVaiTro_x003a__x0020_TenVaiTro"
                  Order: =3
                  Text: |
                    =ThisItem.'MaVaiTro: TenVaiTro'.Value
                  Width: =140

            - 'NguoiDuyetMacDinh: HoTen_Column':
                Control: DataTableColumn
                Variant: Textual
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Người duyệt mặc định"
                  FieldName: ="NguoiDuyetMacDinh_x003a__x0020_HoTen"
                  Order: =4
                  Text: |
                    =ThisItem.'NguoiDuyetMacDinh: HoTen'.Value
                  Width: =200

            - DangHoatDong_Column:
                Control: DataTableColumn
                Variant: Boolean
                IsLocked: true
                Properties:
                  FieldDisplayName: ="Trạng thái"
                  FieldName: ="DangHoatDong"
                  Order: =5
                  Text: |
                    =If(ThisItem.DangHoatDong, "Hoạt động", "Không hoạt động")
                  Width: =120
